\newcommand{\trace}{\text{Trace}}


\chapter{Appendix}

\section{Algorithmen}
  
  
  \subsection{Element-Knotenkräfte}
    \label{AlgoForces}
    Berechnung der Knotenkräfte \texttt{Force}\( \in\R^{3}\times\R^{3} \) für ein Element 
    \(\mathtt{T} \in K^{(2)}\):

    \begin{verbatim}
    for all v in T:
        T <-> [v,v0,v1]
        
        E0 = X(v0) - X(v)
        l0 = length(E0)
        forceLength = d * (l0/lRef - k)

        E1 = X(v1) - X(v)
        l1 = length(E1)
        forceAngle = (d - 1) * ((E0.E1) / (l0*l1) - c);

        Force(v) += project( (forceLength + forceAngle)*(E0/l0) 
                                          + forceAngle *(E1/l1) ) 
    \end{verbatim}

    Parameter \texttt{c,d,k}\( \in\R \), 
    Koordinatenabbildung \texttt{X}\(: \sigma^{0} \mapsto \vec{x}\in M \subset \R^{3} \) 
    und Tangentialprojektion \texttt{project}\(: \R^{3} \rightarrow T_{p}M \subset \R^{3} \)
    sind (approximativ oder exakt) gegeben.

    Zu Beachten ist hierbei, dass die Kantenkraft \texttt{forceLength} nur auf einem Knoten aufgetragen wird.
    Der andere Knoten der ebenfalls zu dieser Kante gehört bekommt die gleiche Kantenkraft aufdatiert, wenn die Knotenkräfte auf dem 2. Dreieckelement, das sich diese Kante teilt, berechnet
    werden.

    
  \subsection{Laplace-Beltrami-Operator}
    \label{subsecAlgoLBeltrami}
    Berechnung der Elementmatrix \( \mathtt{AT}\in\R^{3\times 3} \) für das Dreieckelement
    \( \mathtt{T}\in K^{(2)} \):
    \begin{verbatim}
    for all k in {0,1,2}:
      for all l in {k+1,k+2} mod 3:
        C = T.dualLength(k,l) / T.length(k,l)
        AT(k,k) -= C
        AT(k,l) += C
    \end{verbatim}
    Wobei \texttt{T.length(k,l)} bzw. \texttt{T.dualLength(k,l)} die Länge von
    \( \left[ v^{\mathtt{T}}_{k} , v^{\mathtt{T}}_{l} \right] \) bzw. dessen Dualkante eingeschränkt auf \(
   \mathtt{T} \) ist.

\section{Krümmungsgrößen für impliziten Oberflächen}

  Es sei \( \varphi\in C^{2}(\R^{3}) \) gegeben mit \( M = \left\{ \vec{x}\in\R^{3} \middle| \varphi(\vec{x}) = 0 \right\} \).
  Die Gaußkrümmung \( \mathfrak{K} \) und die Mittlere Krümmung \( \mathfrak{H} \) von \( M \) berechnet sich wie folgt (siehe \cite{CurvatureFormulas}):
  \begin{align}
    \mathfrak{K} &= \frac{\nabla^{T}\varphi \cdot H^{*}[\varphi] \cdot \nabla\varphi}{ \|\nabla\varphi\|_{2}^{4}}
                 = - \frac{\det \begin{bmatrix} H[\varphi] & \nabla\varphi \\ \nabla^{T}\varphi & 0 \end{bmatrix}}{\|\nabla\varphi\|_{2}^{4}} \\
    \mathfrak{H} &= \frac{1}{2}\nabla \cdot \frac{\nabla\varphi}{\|\nabla\varphi\|}
          = \frac{\|\nabla\varphi\|_{2}^{2}\cdot\trace(H[\varphi]) - \nabla^{T}\varphi \cdot H[\varphi] \cdot \nabla\varphi }
                        {2\cdot\|\nabla\varphi\|_{2}^{3}}
  \end{align}
  wobei \( H^{*}[\varphi] \) die Adjunkte\footnote{nicht Adjungierte!} des Hessian \( H[\varphi] \) ist.


\section{Oberflächenbeispiele}

  \subsection{Einheitssphäre}
    \label{sphere}

    \subsubsection{Parametrisierung}
      \begin{align}
      \begin{aligned}
        \vec{x}: \left( 0, \pi \right) \times \left[ 0 , 2\pi \right)
                    &\rightarrow \mathds{S}^{2} \subset \R^{3} \\
             \left( u,v \right) 
                    &\mapsto\begin{bmatrix}
                              x(u,v) \\ y(u,v) \\ z(u,v)
                            \end{bmatrix}
                    := \begin{bmatrix}
                        \sin u \cos v \\
                        \sin u \sin v \\
                        \cos u
                      \end{bmatrix}
      \end{aligned}
      \end{align}
      \( u \) heißt Breitengrad und \( v \) Längengrad.

    \subsubsection{Riemannsche Metrik}
      \begin{align}
        \frac{\partial}{\partial u}\vec{x}
              &=\begin{bmatrix}
                  \cos u \cos v \\
                  \cos u \sin v \\
                  -\sin u
                \end{bmatrix}
              \quad\bot_{\R^{3}}\quad
              \frac{\partial}{\partial v}\vec{x}
              =\begin{bmatrix}
                        -\sin u \sin v \\
                        \sin u \cos v \\
                        0
                \end{bmatrix}
      \end{align}
      \begin{align}
        \Rightarrow g = \begin{bmatrix}
              1 & 0 \\ 0 & \sin^{2} u
            \end{bmatrix}
          =: \diag{g_{u}, g_{v}}
      \end{align}

    \subsubsection{Laplace-Beltrami}
      \begin{align}
        \Delta_{B} &\overset{\eqref{eqLaplaceBeltramiOrthogonal}}{=} \sqrt{g^{u}g^{v}} 
                      \left(  \frac{\partial}{\partial u} 
                             \left( \sqrt{g^{u}g_{v}} \frac{\partial}{\partial u} \right) 
                                  + \frac{\partial}{\partial v} \left( \sqrt{g_{u}g^{v}} \frac{\partial}{\partial v} 
                       \right) \right) \\
                   &= \frac{1}{\sin u}
                      \left(  \frac{\partial}{\partial u} 
                             \left( \sin u \frac{\partial}{\partial u} \right) 
                                  + \frac{\partial}{\partial v} \left( \frac{1}{\sin u} \frac{\partial}{\partial v} 
                       \right) \right) \\
                   &= \cot u \frac{\partial}{\partial u} 
                        + \frac{\partial^{2}}{\partial u^{2}}
                        + \frac{1}{\sin^{2} u} \frac{\partial^{2}}{\partial v^{2}}
      \end{align}

    \subsubsection{Level-Set-Funktion}
      \begin{align}
        \varphi(\vec{x}) &:= \frac{1}{2}\left( \|\vec{x}\|_{2}^{2} - 1 \right) \\
        \nabla\varphi(\vec{x}) &= \vec{x} \\
        H[\varphi] &\equiv I
      \end{align}

     \subsubsection{Krümmungsgrößen}
      \begin{align}
        \mathfrak{K} &\equiv 1 \\
        \mathfrak{H} &\equiv 1
      \end{align}

  \subsection{Ellipsoid}
    \label{heineC}
    
    \subsubsection{Level-Set-Funktion}
      \begin{align}
        \varphi(x,y,z) &:= \frac{1}{2}\left( (3x)^{2} + (6y)^{2} + (2z)^{2} - 9 \right) \\
        \nabla\varphi(x,y,z) &= \left[ 9x, 36y, 4z \right]^{T} \\
        H[\varphi] &\equiv \begin{bmatrix} 9 & 0 & 0 \\
                                             0 & 36 & 0 \\
                                             0 & 0 & 4 \end{bmatrix}
      \end{align}

     \subsubsection{Krümmungsgrößen}
      \begin{align}
        \mathfrak{K}(x,y,z) &= \frac{11664}{(81+972y^{2}-20z^{2})^{2}} \\
        \mathfrak{H}(x,y,z) &= \frac{36 \left(45+54 y^2-10 z^2\right)}{\left(81+972 y^2-20 z^2\right)^{3/2}}
      \end{align}
