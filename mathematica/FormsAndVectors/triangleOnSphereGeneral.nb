(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     51473,       1544]
NotebookOptionsPosition[     49058,       1457]
NotebookOutlinePosition[     49396,       1472]
CellTagsIndexPosition[     49353,       1469]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"sigma1Eps", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Epsilon]", "]"}], "-", "1"}], ",", 
     RowBox[{"Sin", "[", "\[Epsilon]", "]"}], ",", "0"}], "}"}]}], " ", 
  RowBox[{"(*", "Edges", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"sigma1Del", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Delta]", "]"}], "*", 
      RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "-", "1"}], ",", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Delta]", "]"}], "*", 
     RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], ",", 
    RowBox[{"-", 
     RowBox[{"Sin", "[", "\[Delta]", "]"}]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.636178840753042*^9, 3.6361789896472*^9}, {
  3.636184270708537*^9, 3.636184302089746*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ",", 
   RowBox[{"Sin", "[", "\[Epsilon]", "]"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.6361789784297047`*^9, 3.636178990584783*^9}, 
   3.636180126448944*^9, 3.6361814374228477`*^9, 3.636181469360216*^9, 
   3.63618432327771*^9, 3.636184416099677*^9, 3.6361845018639727`*^9, 
   3.636184536775782*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], ",", 
   RowBox[{"-", 
    RowBox[{"Sin", "[", "\[Delta]", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6361789784297047`*^9, 3.636178990584783*^9}, 
   3.636180126448944*^9, 3.6361814374228477`*^9, 3.636181469360216*^9, 
   3.63618432327771*^9, 3.636184416099677*^9, 3.6361845018639727`*^9, 
   3.636184536776558*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"baryToR3", "[", "bc_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"bc", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "*", "sigma1Eps"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"bc", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "*", "sigma1Del"}]}]}]], "Input",
 CellChangeTimes->{{3.636180812931547*^9, 3.636180865767535*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{
    RowBox[{"Outer", "[", 
     RowBox[{"Dot", ",", 
      RowBox[{"{", 
       RowBox[{"sigma1Eps", ",", "sigma1Del"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"sigma1Eps", ",", "sigma1Del"}], "}"}], ",", "1"}], "]"}], "//",
     "Simplify"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"triangle", " ", "metric"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"gInv", " ", "=", " ", 
  RowBox[{
   RowBox[{"Inverse", "[", "g", "]"}], "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.636179142376543*^9, 3.6361792626938334`*^9}, {
  3.636179577303042*^9, 3.636179597591731*^9}, {3.636179638780909*^9, 
  3.6361796399321423`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "-", 
      RowBox[{"2", " ", 
       RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ",", 
     RowBox[{"2", "-", 
      RowBox[{"2", " ", 
       RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.6361792262101994`*^9, 3.6361792631394176`*^9}, 
   3.636179598435858*^9, 3.636179640414554*^9, 3.6361801265945663`*^9, 
   3.636181437587399*^9, 3.636181469463915*^9, 3.636184323443739*^9, 
   3.6361844162399683`*^9, 3.636184501900653*^9, 3.6361845369228563`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"2", "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], 
      RowBox[{
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ")"}], "2"]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"Cos", "[", "\[Epsilon]", "]"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Gamma]", "-", 
          FractionBox["\[Epsilon]", "2"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         FractionBox["\[Epsilon]", "2"], "]"}]}]}], 
      RowBox[{
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ")"}], "2"]}]]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"Cos", "[", "\[Epsilon]", "]"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Gamma]", "-", 
          FractionBox["\[Epsilon]", "2"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         FractionBox["\[Epsilon]", "2"], "]"}]}]}], 
      RowBox[{
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ")"}], "2"]}]], ",", 
     FractionBox[
      RowBox[{"2", "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}]}], 
      RowBox[{
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ")"}], "2"]}]]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6361792262101994`*^9, 3.6361792631394176`*^9}, 
   3.636179598435858*^9, 3.636179640414554*^9, 3.6361801265945663`*^9, 
   3.636181437587399*^9, 3.636181469463915*^9, 3.636184323443739*^9, 
   3.6361844162399683`*^9, 3.636184501900653*^9, 3.636184540809451*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sEps", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"sigma1Eps", "*", "t"}], " ", "+", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"curves", ",", " ", 
    RowBox[{"which", " ", 
     RowBox[{"repr", ".", " ", "edges"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sDel", "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{"sigma1Del", "*", "t"}], " ", "+", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.636179799840781*^9, 3.6361799165796824`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w", "[", "x_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "*", 
     RowBox[{"x", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "*", 
     RowBox[{"x", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], "-", "1"}]}], "}"}], " ", 
  RowBox[{"(*", 
   RowBox[{"example", " ", "=", 
    RowBox[{
     RowBox[{"(", "dz", ")"}], "#"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.636179668119851*^9, 3.636179731516028*^9}, {
   3.636180035304276*^9, 3.636180077104909*^9}, {3.636180140883356*^9, 
   3.636180148616123*^9}, {3.6361804143766527`*^9, 3.636180434056587*^9}, 
   3.636181403896718*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alphaEps", "=", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"sEps", "[", "t", "]"}], "]"}], ".", "sigma1Eps"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", "Simplify", 
   " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"discrete", " ", "1"}], "-", "form"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.636179754500572*^9, 3.636179782486723*^9}, {
   3.63617993581502*^9, 3.636180031102179*^9}, {3.6361800993491707`*^9, 
   3.636180115718052*^9}, {3.636180297561414*^9, 3.636180348460805*^9}, {
   3.6361803966650476`*^9, 3.636180409904291*^9}, {3.636180440781926*^9, 
   3.636180548033506*^9}, {3.636180659208641*^9, 3.636180673669087*^9}, 
   3.636181408195361*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.636180016300511*^9, {3.636180081819868*^9, 3.636180126799708*^9}, 
   3.6361801884077177`*^9, {3.636180300146063*^9, 3.636180348884273*^9}, {
   3.636180399968587*^9, 3.6361804106046677`*^9}, {3.636180457266008*^9, 
   3.636180467488118*^9}, 3.63618054901437*^9, 3.636180675688539*^9, 
   3.636181437814164*^9, 3.636181469696794*^9, 3.636184327518231*^9, 
   3.636184420313675*^9, 3.636184502025475*^9, 3.636184540925684*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alphaDel", "=", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"sDel", "[", "t", "]"}], "]"}], ".", "sigma1Del"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.636180556631857*^9, 3.636180608799152*^9}, 
   3.636181410993577*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{"5", "+", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
  RowBox[{"Sin", "[", "\[Delta]", "]"}]}]], "Output",
 CellChangeTimes->{{3.636180568309252*^9, 3.636180616228346*^9}, 
   3.636181437871008*^9, 3.636181469757122*^9, 3.636184327585321*^9, 
   3.636184420381802*^9, 3.636184502081469*^9, 3.6361845409924717`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bary", " ", "=", " ", 
  RowBox[{
   RowBox[{"gInv", ".", 
    RowBox[{"{", 
     RowBox[{"alphaEps", ",", "alphaDel"}], "}"}]}], "//", "FullSimplify", 
   " ", 
   RowBox[{"(*", 
    RowBox[{"coords", " ", "in", " ", "edge", " ", "basis", " ", 
     RowBox[{"(", "barycoords", ")"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.6361806859247913`*^9, 3.636180771717155*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"5", "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "\[Delta]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"Cos", "[", "\[Epsilon]", "]"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Gamma]", "-", 
          FractionBox["\[Epsilon]", "2"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         FractionBox["\[Epsilon]", "2"], "]"}]}]}], ")"}]}], 
    RowBox[{"6", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ")"}], "2"]}], 
      ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"5", "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"2", "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "\[Delta]", "]"}]}], 
    RowBox[{"6", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ")"}], "2"]}], 
      ")"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.636180734125866*^9, 3.6361807723483057`*^9}, 
   3.636181438013303*^9, 3.636181469907056*^9, 3.6361843288611307`*^9, 
   3.6361844216596518`*^9, 3.636184502141528*^9, 3.636184542269246*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alphaSharp", "=", 
  RowBox[{
   RowBox[{"baryToR3", "[", "bary", "]"}], "//", "FullSimplify"}]}]], "Input",\

 CellChangeTimes->{{3.636180782156746*^9, 3.636180795307356*^9}, {
   3.6361808754625883`*^9, 3.636180899128138*^9}, 3.6361813816718616`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"5", "+", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Epsilon]", "2"], "]"}], " ", 
      RowBox[{"Sin", "[", "\[Delta]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          FractionBox["\[Epsilon]", "2"], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Epsilon]", "2"], "]"}]}]}], ")"}]}], 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "5"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Gamma]", "-", "\[Delta]"}], "]"}]}], "+", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Delta]"}], "]"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Gamma]", "+", "\[Delta]"}], "]"}]}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Gamma]", "-", "\[Epsilon]"}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Delta]", "]"}], "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"2", " ", "\[Gamma]"}], "-", "\[Epsilon]"}], "]"}]}], "-", 
        
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}]}], ")"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"5", "+", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Delta]", "]"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Epsilon]", "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          FractionBox["\[Epsilon]", "2"], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Epsilon]", "2"], "]"}]}]}], ")"}]}], 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "5"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Gamma]", "-", "\[Delta]"}], "]"}]}], "+", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Delta]"}], "]"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Gamma]", "+", "\[Delta]"}], "]"}]}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Gamma]", "-", "\[Epsilon]"}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Delta]", "]"}], "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"2", " ", "\[Gamma]"}], "-", "\[Epsilon]"}], "]"}]}], "-", 
        
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}]}], ")"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"5", "+", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "-", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Delta]", "]"}], "2"]}], 
     RowBox[{"6", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ")"}], "2"]}], 
       ")"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.63618089352145*^9, 3.636180899768149*^9}, 
   3.636181382286352*^9, 3.6361814381302567`*^9, 3.636181470022986*^9, 
   3.636184330401985*^9, 3.636184423169002*^9, 3.636184502287508*^9, 
   3.636184543791257*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{"Limit", "[", 
     RowBox[{
      RowBox[{"Limit", "[", 
       RowBox[{"alphaSharp", ",", 
        RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], "]"}], ",", 
      RowBox[{"\[Gamma]", "\[Rule]", "0"}]}], "]"}], ",", 
    RowBox[{"\[Delta]", "\[Rule]", "0"}]}], "]"}], "==", 
  RowBox[{"w", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6361810085525713`*^9, 3.636181070183951*^9}, {
  3.636181112343218*^9, 3.636181116994163*^9}, {3.63618142732148*^9, 
  3.636181445271957*^9}, {3.636184340755789*^9, 3.636184355868948*^9}, {
  3.636184736245681*^9, 3.636184742307352*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.636181031861702*^9, 3.636181070849969*^9, 3.6361811179583473`*^9, {
   3.6361814381511*^9, 3.6361814701403837`*^9}, 3.636184331805613*^9, 
   3.636184380571871*^9, 3.636184424592844*^9, 3.636184502323257*^9, 
   3.6361845451922626`*^9, 3.636184743206176*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"w", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "0", ",", "0"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{3.636184573528055*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"alphaSharp", ",", 
    RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.636184629968711*^9, 3.6361846365909967`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "38"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Gamma]"}], "]"}]}], "+", 
       RowBox[{"16", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Gamma]", "-", "\[Delta]"}], "]"}]}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Gamma]", "-", "\[Delta]"}], ")"}]}], "]"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Delta]"}], "]"}]}], "+", 
       RowBox[{"16", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Gamma]", "+", "\[Delta]"}], "]"}]}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Gamma]", "+", "\[Delta]"}], ")"}]}], "]"}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "\[Delta]", "]"}]}], 
    RowBox[{"6", " ", 
     RowBox[{"(", 
      RowBox[{"14", "+", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Gamma]"}], "]"}]}], "-", 
       RowBox[{"8", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Gamma]", "-", "\[Delta]"}], "]"}]}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Gamma]", "-", "\[Delta]"}], ")"}]}], "]"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Delta]"}], "]"}]}], "-", 
       RowBox[{"8", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Gamma]", "+", "\[Delta]"}], "]"}]}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Gamma]", "+", "\[Delta]"}], ")"}]}], "]"}]}], ")"}]}]], 
   ",", "0", ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"5", "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Delta]", "]"}], "2"]}], 
    RowBox[{"6", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Delta]", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Delta]", "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Gamma]", "]"}], "2"]}]}], ")"}]}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.636184603879154*^9, 3.636184637427985*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"Limit", "[", 
    RowBox[{"alphaSharp", ",", 
     RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], "]"}], ",", 
   RowBox[{"\[Gamma]", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.636184660004547*^9, 3.636184661584114*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "12"]}], " ", 
    RowBox[{"(", 
     RowBox[{"5", "+", 
      RowBox[{"Cos", "[", "\[Delta]", "]"}]}], ")"}], " ", 
    RowBox[{"Sin", "[", "\[Delta]", "]"}]}], ",", "0", ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "6"]}], " ", 
    SuperscriptBox[
     RowBox[{"Cos", "[", 
      FractionBox["\[Delta]", "2"], "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{"5", "+", 
      RowBox[{"Cos", "[", "\[Delta]", "]"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6361845180156813`*^9, 3.636184545307173*^9}, 
   3.636184662664378*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{"Limit", "[", 
      RowBox[{"alphaSharp", ",", 
       RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], "]"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "0"}]}], "]"}], ",", 
   RowBox[{"\[Delta]", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.636184668108531*^9, 3.636184674668263*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{3.636184502358769*^9, 3.6361845453456078`*^9, 
  3.636184676441927*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"b1", "[", "x_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "*", 
      RowBox[{"x", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "*", 
      RowBox[{"x", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], "-", "1"}]}], "}"}]}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{"tangential", " ", "basis", " ", "vectors"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", "[", "x_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"x", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{"x", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"a1", "*", 
    RowBox[{"b1", "[", "x", "]"}]}], "+", 
   RowBox[{"a2", "*", 
    RowBox[{"b2", "[", "x", "]"}], " ", 
    RowBox[{"(*", 
     RowBox[{"general", " ", "example"}], "*)"}]}]}]}]], "Input",
 CellChangeTimes->{3.636184814403695*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alphaEps", "=", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"sEps", "[", "t", "]"}], "]"}], ".", "sigma1Eps"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", "Simplify", 
   " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"discrete", " ", "1"}], "-", "form"}], "*)"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"a2", " ", 
  RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]], "Output",
 CellChangeTimes->{3.636184824317712*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alphaDel", "=", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"sDel", "[", "t", "]"}], "]"}], ".", "sigma1Del"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"6", " ", "a2", " ", 
     RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
    RowBox[{"5", " ", "a1", " ", 
     RowBox[{"Sin", "[", "\[Delta]", "]"}]}], "+", 
    RowBox[{"a1", " ", 
     RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Delta]", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.6361848319303703`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bary", " ", "=", " ", 
  RowBox[{
   RowBox[{"gInv", ".", 
    RowBox[{"{", 
     RowBox[{"alphaEps", ",", "alphaDel"}], "}"}]}], "//", "FullSimplify", 
   " ", 
   RowBox[{"(*", 
    RowBox[{"coords", " ", "in", " ", "edge", " ", "basis", " ", 
     RowBox[{"(", "barycoords", ")"}]}], "*)"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"6", " ", "a2", " ", 
         RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
        RowBox[{"a1", " ", 
         RowBox[{"(", 
          RowBox[{"5", "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"Cos", "[", "\[Epsilon]", "]"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Gamma]", "-", 
           FractionBox["\[Epsilon]", "2"]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Epsilon]", "2"], "]"}]}]}], ")"}]}], "+", 
     RowBox[{"6", " ", "a2", " ", 
      RowBox[{"(", 
       RowBox[{"2", "-", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], 
    RowBox[{"6", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ")"}], "2"]}], 
      ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"4", " ", 
      RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "a2", " ", 
         RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
        RowBox[{"a1", " ", 
         RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Delta]", "]"}]}], "-", 
        RowBox[{"3", " ", "a2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Gamma]", "-", "\[Epsilon]"}], "]"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        FractionBox["\[Epsilon]", "2"], "]"}], "2"]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"5", " ", "a1", " ", 
         RowBox[{"Sin", "[", "\[Delta]", "]"}]}], "-", 
        RowBox[{"3", " ", "a2", " ", 
         RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ")"}]}]}], 
    RowBox[{"6", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
              RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ")"}], "2"]}], 
      ")"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.636184844670141*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alphaSharp", "=", 
  RowBox[{
   RowBox[{"baryToR3", "[", "bary", "]"}], "//", "FullSimplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Epsilon]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"6", " ", "a2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Delta]", "]"}], "2"], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Epsilon]", "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a1", " ", 
            RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Gamma]", "-", 
              FractionBox["\[Epsilon]", "2"]}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Delta]", "]"}]}], "+", 
           RowBox[{"6", " ", "a2", " ", 
            RowBox[{"Sin", "[", 
             FractionBox["\[Epsilon]", "2"], "]"}]}]}], ")"}]}], "-", 
        RowBox[{"5", " ", "a1", " ", 
         RowBox[{"Sin", "[", "\[Delta]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}], "+", 
        RowBox[{"a1", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Delta]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"5", " ", 
            RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              FractionBox["\[Epsilon]", "2"], "]"}], "2"]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ")"}]}]}], ")"}]}], 
     ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"6", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ")"}], "2"]}], 
       ")"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "\[Epsilon]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"6", " ", "a2", " ", 
             RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
            RowBox[{"a1", " ", 
             RowBox[{"(", 
              RowBox[{"5", "+", 
               RowBox[{
                RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
                RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
             RowBox[{"Sin", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", "\[Epsilon]", "]"}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Gamma]", "-", 
               FractionBox["\[Epsilon]", "2"]}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              FractionBox["\[Epsilon]", "2"], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"6", " ", "a2", " ", 
          RowBox[{"(", 
           RowBox[{"2", "-", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
             RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", " ", "a2", " ", 
             RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
            RowBox[{"a1", " ", 
             RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Delta]", "]"}]}], "-", 
            RowBox[{"3", " ", "a2", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Gamma]", "-", "\[Epsilon]"}], "]"}]}]}], ")"}], " ", 
          
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            FractionBox["\[Epsilon]", "2"], "]"}], "2"]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"5", " ", "a1", " ", 
             RowBox[{"Sin", "[", "\[Delta]", "]"}]}], "-", 
            RowBox[{"3", " ", "a2", " ", 
             RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ")"}]}]}], 
        ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"6", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ")"}], "2"]}], 
       ")"}]}], ")"}]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"Sin", "[", "\[Delta]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "a2", " ", 
            RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], "+", 
           RowBox[{"a1", " ", 
            RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Delta]", "]"}]}], "-", 
           RowBox[{"3", " ", "a2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Gamma]", "-", "\[Epsilon]"}], "]"}]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           FractionBox["\[Epsilon]", "2"], "]"}], "2"]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"5", " ", "a1", " ", 
            RowBox[{"Sin", "[", "\[Delta]", "]"}]}], "-", 
           RowBox[{"3", " ", "a2", " ", 
            RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ")"}]}]}], ")"}]}], 
     RowBox[{"6", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Delta]", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"Cos", "[", "\[Epsilon]", "]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Gamma]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}]}], ")"}], "2"]}], 
       ")"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6361848626649437`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{"Limit", "[", 
      RowBox[{"alphaSharp", ",", 
       RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], "]"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "0"}]}], "]"}], ",", 
   RowBox[{"\[Delta]", "\[Rule]", "0"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "a2", ",", 
   RowBox[{"-", "a1"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6361848760867167`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"w", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "0", ",", "0"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "a2", ",", 
   RowBox[{"-", "a1"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6361848894478827`*^9}]
}, Open  ]]
},
WindowSize->{1280, 975},
WindowMargins->{{Automatic, 1024}, {Automatic, 0}},
FrontEndVersion->"8.0 for Linux x86 (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 827, 22, 50, "Input"],
Cell[1409, 46, 445, 10, 30, "Output"],
Cell[1857, 58, 629, 16, 30, "Output"]
}, Open  ]],
Cell[2501, 77, 364, 10, 30, "Input"],
Cell[CellGroupData[{
Cell[2890, 91, 702, 18, 50, "Input"],
Cell[3595, 111, 1799, 50, 50, "Output"],
Cell[5397, 163, 5870, 163, 195, "Output"]
}, Open  ]],
Cell[11282, 329, 637, 18, 50, "Input"],
Cell[11922, 349, 886, 26, 30, "Input"],
Cell[CellGroupData[{
Cell[12833, 379, 802, 19, 30, "Input"],
Cell[13638, 400, 478, 7, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14153, 412, 410, 12, 30, "Input"],
Cell[14566, 426, 478, 11, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15081, 442, 400, 10, 30, "Input"],
Cell[15484, 454, 3610, 102, 108, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19131, 561, 276, 6, 30, "Input"],
Cell[19410, 569, 5706, 157, 166, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25153, 731, 708, 17, 30, "Input"],
Cell[25864, 750, 314, 5, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26215, 760, 111, 3, 30, "Input"],
Cell[26329, 765, 144, 4, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26510, 774, 233, 6, 30, "Input"],
Cell[26746, 782, 2584, 75, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29367, 862, 292, 7, 30, "Input"],
Cell[29662, 871, 648, 20, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30347, 896, 395, 10, 30, "Input"],
Cell[30745, 908, 193, 5, 30, "Output"]
}, Open  ]],
Cell[30953, 916, 939, 32, 50, "Input"],
Cell[31895, 950, 331, 10, 30, "Input"],
Cell[CellGroupData[{
Cell[32251, 964, 415, 13, 30, "Input"],
Cell[32669, 979, 132, 3, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32838, 987, 318, 10, 30, "Input"],
Cell[33159, 999, 540, 14, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33736, 1018, 332, 9, 30, "Input"],
Cell[34071, 1029, 4625, 130, 119, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38733, 1164, 132, 3, 30, "Input"],
Cell[38868, 1169, 9358, 251, 256, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48263, 1425, 329, 9, 30, "Input"],
Cell[48595, 1436, 148, 4, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48780, 1445, 111, 3, 30, "Input"],
Cell[48894, 1450, 148, 4, 30, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
