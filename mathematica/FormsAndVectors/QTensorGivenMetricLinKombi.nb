(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     59532,       1802]
NotebookOptionsPosition[     57383,       1732]
NotebookOutlinePosition[     57721,       1747]
CellTagsIndexPosition[     57678,       1744]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", "FormsAndVectors`"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"gS", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"Sin", "[", "x", "]"}], "^", "2"}]}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gOrtho", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"g11", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "g22"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gG", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"g11", "[", 
        RowBox[{"x", ",", "y"}], "]"}], ",", 
       RowBox[{"g12", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"g12", "[", 
        RowBox[{"x", ",", "y"}], "]"}], ",", 
       RowBox[{"g22", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"g", "=", 
  RowBox[{"gG", "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"gInv", " ", "=", " ", 
  RowBox[{
   RowBox[{"Inverse", "[", "g", "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{"g11", ">", "0"}], "&&", 
   RowBox[{"g22", ">", "0"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"vol", "=", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{"Det", "[", "g", "]"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"K", "=", 
  RowBox[{
   RowBox[{"GaussCurvFromMetric", "[", 
    RowBox[{"x", ",", "y", ",", "g"}], "]"}], "//", "Simplify"}]}]}], "Input",\

 CellChangeTimes->{{3.657353776909514*^9, 3.65735379032337*^9}, {
  3.657353842603302*^9, 3.657353860299955*^9}, {3.6573538934689693`*^9, 
  3.657353923115963*^9}, {3.6575347145497227`*^9, 3.6575347508854713`*^9}, {
  3.657951578258872*^9, 3.657951595504407*^9}, {3.657952019981277*^9, 
  3.657952021719985*^9}, {3.657952088324383*^9, 3.657952089860435*^9}, {
  3.657955180741535*^9, 3.6579552174971857`*^9}, {3.6580323665855627`*^9, 
  3.658032367912006*^9}, {3.658033232167294*^9, 3.6580332340091753`*^9}, {
  3.658044094039137*^9, 3.658044120089241*^9}, {3.6580459027087727`*^9, 
  3.6580460022968063`*^9}, {3.658046117484086*^9, 3.658046117912608*^9}, {
  3.6582070756641903`*^9, 3.6582070759265833`*^9}, {3.658207754231946*^9, 
  3.65820775464156*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "x", "]"}], "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.657353890253048*^9, 3.657353928433591*^9, 3.657534686474978*^9, 
   3.6575347530004263`*^9, 3.657537702779735*^9, 3.657885660676463*^9, 
   3.657951387221681*^9, 3.657951598982152*^9, 3.6579520262907753`*^9, 
   3.657952092363743*^9, 3.657955217964918*^9, 3.65803237080023*^9, 
   3.658033236749761*^9, 3.658038432576723*^9, 3.658040300709723*^9, 
   3.6580440225998487`*^9, 3.658044189960322*^9, 3.658045926138226*^9, {
   3.6580459793613987`*^9, 3.658046010233301*^9}, 3.658046124656591*^9, 
   3.658142264639523*^9, 3.658207078870194*^9, 3.6582253988852453`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"g11", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"g12", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"g12", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"g22", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.657353890253048*^9, 3.657353928433591*^9, 3.657534686474978*^9, 
   3.6575347530004263`*^9, 3.657537702779735*^9, 3.657885660676463*^9, 
   3.657951387221681*^9, 3.657951598982152*^9, 3.6579520262907753`*^9, 
   3.657952092363743*^9, 3.657955217964918*^9, 3.65803237080023*^9, 
   3.658033236749761*^9, 3.658038432576723*^9, 3.658040300709723*^9, 
   3.6580440225998487`*^9, 3.658044189960322*^9, 3.658045926138226*^9, {
   3.6580459793613987`*^9, 3.658046010233301*^9}, 3.658046124656591*^9, 
   3.658142264639523*^9, 3.658207078870194*^9, 3.658225398885902*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"g22", "[", 
       RowBox[{"x", ",", "y"}], "]"}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"g12", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]], ",", 
     FractionBox[
      RowBox[{"g12", "[", 
       RowBox[{"x", ",", "y"}], "]"}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"g12", "[", 
       RowBox[{"x", ",", "y"}], "]"}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]], ",", 
     FractionBox[
      RowBox[{"g11", "[", 
       RowBox[{"x", ",", "y"}], "]"}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"g12", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.657353890253048*^9, 3.657353928433591*^9, 3.657534686474978*^9, 
   3.6575347530004263`*^9, 3.657537702779735*^9, 3.657885660676463*^9, 
   3.657951387221681*^9, 3.657951598982152*^9, 3.6579520262907753`*^9, 
   3.657952092363743*^9, 3.657955217964918*^9, 3.65803237080023*^9, 
   3.658033236749761*^9, 3.658038432576723*^9, 3.658040300709723*^9, 
   3.6580440225998487`*^9, 3.658044189960322*^9, 3.658045926138226*^9, {
   3.6580459793613987`*^9, 3.658046010233301*^9}, 3.658046124656591*^9, 
   3.658142264639523*^9, 3.658207078870194*^9, 3.65822539888687*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"g11", ">", "0"}], "&&", 
  RowBox[{"g22", ">", "0"}]}]], "Output",
 CellChangeTimes->{
  3.657353890253048*^9, 3.657353928433591*^9, 3.657534686474978*^9, 
   3.6575347530004263`*^9, 3.657537702779735*^9, 3.657885660676463*^9, 
   3.657951387221681*^9, 3.657951598982152*^9, 3.6579520262907753`*^9, 
   3.657952092363743*^9, 3.657955217964918*^9, 3.65803237080023*^9, 
   3.658033236749761*^9, 3.658038432576723*^9, 3.658040300709723*^9, 
   3.6580440225998487`*^9, 3.658044189960322*^9, 3.658045926138226*^9, {
   3.6580459793613987`*^9, 3.658046010233301*^9}, 3.658046124656591*^9, 
   3.658142264639523*^9, 3.658207078870194*^9, 3.658225398887388*^9}],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox[
     RowBox[{"g12", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
   RowBox[{
    RowBox[{"g11", "[", 
     RowBox[{"x", ",", "y"}], "]"}], " ", 
    RowBox[{"g22", "[", 
     RowBox[{"x", ",", "y"}], "]"}]}]}]]], "Output",
 CellChangeTimes->{
  3.657353890253048*^9, 3.657353928433591*^9, 3.657534686474978*^9, 
   3.6575347530004263`*^9, 3.657537702779735*^9, 3.657885660676463*^9, 
   3.657951387221681*^9, 3.657951598982152*^9, 3.6579520262907753`*^9, 
   3.657952092363743*^9, 3.657955217964918*^9, 3.65803237080023*^9, 
   3.658033236749761*^9, 3.658038432576723*^9, 3.658040300709723*^9, 
   3.6580440225998487`*^9, 3.658044189960322*^9, 3.658045926138226*^9, {
   3.6580459793613987`*^9, 3.658046010233301*^9}, 3.658046124656591*^9, 
   3.658142264639523*^9, 3.658207078870194*^9, 3.6582253988880177`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"g11", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"g22", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"g11", "[", 
      RowBox[{"x", ",", "y"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["g11", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["g22", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "+", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["g22", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"g22", "[", 
      RowBox[{"x", ",", "y"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["g11", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"], "+", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g11", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["g22", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g11", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}], "+", 
          RowBox[{
           SuperscriptBox["g22", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.657353890253048*^9, 3.657353928433591*^9, 3.657534686474978*^9, 
   3.6575347530004263`*^9, 3.657537702779735*^9, 3.657885660676463*^9, 
   3.657951387221681*^9, 3.657951598982152*^9, 3.6579520262907753`*^9, 
   3.657952092363743*^9, 3.657955217964918*^9, 3.65803237080023*^9, 
   3.658033236749761*^9, 3.658038432576723*^9, 3.658040300709723*^9, 
   3.6580440225998487`*^9, 3.658044189960322*^9, 3.658045926138226*^9, {
   3.6580459793613987`*^9, 3.658046010233301*^9}, 3.658046124656591*^9, 
   3.658142264639523*^9, 3.658207078870194*^9, 3.658225398889727*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Alpha]", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a1", "[", 
     RowBox[{"x", ",", "y"}], "]"}], ",", 
    RowBox[{"a2", "[", 
     RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"h\[Alpha]", "=", 
  RowBox[{
   RowBox[{"Hodge1", "[", 
    RowBox[{"\[Alpha]", ",", "g"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"p", "=", 
  RowBox[{
   RowBox[{"Sharp1", "[", 
    RowBox[{"\[Alpha]", ",", "g"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"hp", "=", 
  RowBox[{
   RowBox[{"Sharp1", "[", 
    RowBox[{"h\[Alpha]", ",", "g"}], "]"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.657951366846259*^9, 3.657951504892684*^9}, {
  3.658044143490068*^9, 3.6580441498752413`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a1", "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   RowBox[{"a2", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6579515069780617`*^9, 3.657951598989036*^9, 
  3.6579520262992496`*^9, 3.657952092369343*^9, 3.658032370812559*^9, 
  3.658033236761643*^9, 3.6580384325957212`*^9, 3.65804030071591*^9, 
  3.658044022691313*^9, 3.658044189999301*^9, 3.658046010248811*^9, 
  3.6580461246732607`*^9, 3.6581422647451572`*^9, 3.658207078880183*^9, 
  3.658225398894888*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"a2", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], " ", 
      RowBox[{"g11", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"a1", "[", 
       RowBox[{"x", ",", "y"}], "]"}], " ", 
      RowBox[{"g12", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}], 
    SqrtBox[
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"g11", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{"g22", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}]]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"a2", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], " ", 
      RowBox[{"g12", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"a1", "[", 
       RowBox[{"x", ",", "y"}], "]"}], " ", 
      RowBox[{"g22", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}], 
    SqrtBox[
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"g11", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{"g22", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}]]]}], "}"}]], "Output",
 CellChangeTimes->{3.6579515069780617`*^9, 3.657951598989036*^9, 
  3.6579520262992496`*^9, 3.657952092369343*^9, 3.658032370812559*^9, 
  3.658033236761643*^9, 3.6580384325957212`*^9, 3.65804030071591*^9, 
  3.658044022691313*^9, 3.658044189999301*^9, 3.658046010248811*^9, 
  3.6580461246732607`*^9, 3.6581422647451572`*^9, 3.658207078880183*^9, 
  3.658225398896029*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"a2", "[", 
       RowBox[{"x", ",", "y"}], "]"}], " ", 
      RowBox[{"g12", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"a1", "[", 
       RowBox[{"x", ",", "y"}], "]"}], " ", 
      RowBox[{"g22", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"g12", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
     RowBox[{
      RowBox[{"g11", "[", 
       RowBox[{"x", ",", "y"}], "]"}], " ", 
      RowBox[{"g22", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"a2", "[", 
       RowBox[{"x", ",", "y"}], "]"}], " ", 
      RowBox[{"g11", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"a1", "[", 
       RowBox[{"x", ",", "y"}], "]"}], " ", 
      RowBox[{"g12", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}], 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"g12", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"g11", "[", 
       RowBox[{"x", ",", "y"}], "]"}], " ", 
      RowBox[{"g22", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.6579515069780617`*^9, 3.657951598989036*^9, 
  3.6579520262992496`*^9, 3.657952092369343*^9, 3.658032370812559*^9, 
  3.658033236761643*^9, 3.6580384325957212`*^9, 3.65804030071591*^9, 
  3.658044022691313*^9, 3.658044189999301*^9, 3.658046010248811*^9, 
  3.6580461246732607`*^9, 3.6581422647451572`*^9, 3.658207078880183*^9, 
  3.6582253988970013`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"a2", "[", 
      RowBox[{"x", ",", "y"}], "]"}], 
     SqrtBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"g12", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]]]}], ",", 
   FractionBox[
    RowBox[{"a1", "[", 
     RowBox[{"x", ",", "y"}], "]"}], 
    SqrtBox[
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"g11", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{"g22", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}]]]}], "}"}]], "Output",
 CellChangeTimes->{3.6579515069780617`*^9, 3.657951598989036*^9, 
  3.6579520262992496`*^9, 3.657952092369343*^9, 3.658032370812559*^9, 
  3.658033236761643*^9, 3.6580384325957212`*^9, 3.65804030071591*^9, 
  3.658044022691313*^9, 3.658044189999301*^9, 3.658046010248811*^9, 
  3.6580461246732607`*^9, 3.6581422647451572`*^9, 3.658207078880183*^9, 
  3.658225398897893*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Beta]", "=", 
   RowBox[{"{", 
    RowBox[{"b1", ",", "b2"}], "}"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"\[Beta]", "=", 
    RowBox[{
     RowBox[{"vol", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "-", " ", 
        RowBox[{"2", 
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], "*", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"v", "=", 
  RowBox[{
   RowBox[{"Sharp1", "[", 
    RowBox[{"\[Beta]", ",", "g"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]", ".", "v"}], "//", "Simplify"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"v", "=", 
    RowBox[{"{", 
     RowBox[{"v1", ",", "v2"}], "}"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"vfl", "=", 
  RowBox[{
   RowBox[{"Flat1", "[", 
    RowBox[{"v", ",", "g"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"hvfl", "=", 
  RowBox[{
   RowBox[{"Hodge1", "[", 
    RowBox[{"vfl", ",", "g"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"hv", "=", 
  RowBox[{
   RowBox[{"Sharp1", "[", 
    RowBox[{"hvfl", ",", "g"}], "]"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.65803838649603*^9, 3.658038465749048*^9}, {
  3.6580393457705*^9, 3.658039391109674*^9}, {3.658040288944765*^9, 
  3.6580402958403177`*^9}, {3.6580403575502377`*^9, 3.658040373685607*^9}, {
  3.658043572101788*^9, 3.658043623660862*^9}, {3.658044163374776*^9, 
  3.658044186185174*^9}, {3.658137234940612*^9, 3.65813729957766*^9}, {
  3.658142250707016*^9, 3.6581422570115547`*^9}, {3.658143022807959*^9, 
  3.658143041169073*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"b1", ",", "b2"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6580384326355057`*^9, 3.658038466184651*^9, 3.658039394989183*^9, 
   3.658040300721635*^9, 3.658040374895214*^9, 3.658043624877468*^9, 
   3.658044022759285*^9, 3.658044190073122*^9, 3.658046010293891*^9, 
   3.6580461246869802`*^9, {3.658137279535987*^9, 3.6581373004043903`*^9}, 
   3.658142264820383*^9, 3.658143041840015*^9, 3.658207078918027*^9, 
   3.658225398907099*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"b2", " ", 
      RowBox[{"g12", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], "-", 
     RowBox[{"b1", " ", 
      RowBox[{"g22", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"g12", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
     RowBox[{
      RowBox[{"g11", "[", 
       RowBox[{"x", ",", "y"}], "]"}], " ", 
      RowBox[{"g22", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"b2", " ", 
      RowBox[{"g11", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], "-", 
     RowBox[{"b1", " ", 
      RowBox[{"g12", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}], 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"g12", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"g11", "[", 
       RowBox[{"x", ",", "y"}], "]"}], " ", 
      RowBox[{"g22", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6580384326355057`*^9, 3.658038466184651*^9, 3.658039394989183*^9, 
   3.658040300721635*^9, 3.658040374895214*^9, 3.658043624877468*^9, 
   3.658044022759285*^9, 3.658044190073122*^9, 3.658046010293891*^9, 
   3.6580461246869802`*^9, {3.658137279535987*^9, 3.6581373004043903`*^9}, 
   3.658142264820383*^9, 3.658143041840015*^9, 3.658207078918027*^9, 
   3.658225398908203*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["b2", "2"], " ", 
    RowBox[{"g11", "[", 
     RowBox[{"x", ",", "y"}], "]"}]}], "+", 
   RowBox[{"b1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "b2", " ", 
       RowBox[{"g12", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "+", 
      RowBox[{"b1", " ", 
       RowBox[{"g22", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}]}]}], 
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox[
     RowBox[{"g12", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
   RowBox[{
    RowBox[{"g11", "[", 
     RowBox[{"x", ",", "y"}], "]"}], " ", 
    RowBox[{"g22", "[", 
     RowBox[{"x", ",", "y"}], "]"}]}]}]]], "Output",
 CellChangeTimes->{
  3.6580384326355057`*^9, 3.658038466184651*^9, 3.658039394989183*^9, 
   3.658040300721635*^9, 3.658040374895214*^9, 3.658043624877468*^9, 
   3.658044022759285*^9, 3.658044190073122*^9, 3.658046010293891*^9, 
   3.6580461246869802`*^9, {3.658137279535987*^9, 3.6581373004043903`*^9}, 
   3.658142264820383*^9, 3.658143041840015*^9, 3.658207078918027*^9, 
   3.658225398909462*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"b1", ",", "b2"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6580384326355057`*^9, 3.658038466184651*^9, 3.658039394989183*^9, 
   3.658040300721635*^9, 3.658040374895214*^9, 3.658043624877468*^9, 
   3.658044022759285*^9, 3.658044190073122*^9, 3.658046010293891*^9, 
   3.6580461246869802`*^9, {3.658137279535987*^9, 3.6581373004043903`*^9}, 
   3.658142264820383*^9, 3.658143041840015*^9, 3.658207078918027*^9, 
   3.6582253989105597`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "b2"}], " ", 
      RowBox[{"g11", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], "+", 
     RowBox[{"b1", " ", 
      RowBox[{"g12", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}], 
    SqrtBox[
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"g11", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{"g22", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}]]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "b2"}], " ", 
      RowBox[{"g12", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], "+", 
     RowBox[{"b1", " ", 
      RowBox[{"g22", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}], 
    SqrtBox[
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"g11", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{"g22", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6580384326355057`*^9, 3.658038466184651*^9, 3.658039394989183*^9, 
   3.658040300721635*^9, 3.658040374895214*^9, 3.658043624877468*^9, 
   3.658044022759285*^9, 3.658044190073122*^9, 3.658046010293891*^9, 
   3.6580461246869802`*^9, {3.658137279535987*^9, 3.6581373004043903`*^9}, 
   3.658142264820383*^9, 3.658143041840015*^9, 3.658207078918027*^9, 
   3.6582253989115458`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["b2", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"g12", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]]]}], ",", 
   FractionBox["b1", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"g11", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{"g22", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6580384326355057`*^9, 3.658038466184651*^9, 3.658039394989183*^9, 
   3.658040300721635*^9, 3.658040374895214*^9, 3.658043624877468*^9, 
   3.658044022759285*^9, 3.658044190073122*^9, 3.658046010293891*^9, 
   3.6580461246869802`*^9, {3.658137279535987*^9, 3.6581373004043903`*^9}, 
   3.658142264820383*^9, 3.658143041840015*^9, 3.658207078918027*^9, 
   3.6582253989128437`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Qfl", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Outer", "[", 
     RowBox[{"Times", ",", "vfl", ",", "\[Alpha]"}], "]"}], "-", 
    RowBox[{"Outer", "[", 
     RowBox[{"Times", ",", "hvfl", ",", "h\[Alpha]"}], "]"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qfl", "-", 
   RowBox[{"Transpose", "[", "Qfl", "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"Q", "=", 
  RowBox[{
   RowBox[{"gInv", ".", "Qfl"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tr", "[", "Q", "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.658038493521908*^9, 3.658038554687008*^9}, {
  3.6580386170797987`*^9, 3.658038647111435*^9}, {3.658038704611063*^9, 
  3.6580387325560703`*^9}, {3.658225209721058*^9, 3.658225250508931*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"b1", " ", 
       RowBox[{"a1", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b2", " ", 
           RowBox[{"g11", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "-", 
          RowBox[{"b1", " ", 
           RowBox[{"g12", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a2", "[", 
            RowBox[{"x", ",", "y"}], "]"}], " ", 
           RowBox[{"g11", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"a1", "[", 
            RowBox[{"x", ",", "y"}], "]"}], " ", 
           RowBox[{"g12", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"g12", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"g11", "[", 
          RowBox[{"x", ",", "y"}], "]"}], " ", 
         RowBox[{"g22", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}]}]]}], ",", 
     RowBox[{
      RowBox[{"b1", " ", 
       RowBox[{"a2", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b2", " ", 
           RowBox[{"g11", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "-", 
          RowBox[{"b1", " ", 
           RowBox[{"g12", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a2", "[", 
            RowBox[{"x", ",", "y"}], "]"}], " ", 
           RowBox[{"g12", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"a1", "[", 
            RowBox[{"x", ",", "y"}], "]"}], " ", 
           RowBox[{"g22", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"g12", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"g11", "[", 
          RowBox[{"x", ",", "y"}], "]"}], " ", 
         RowBox[{"g22", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"b2", " ", 
       RowBox[{"a1", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a2", "[", 
            RowBox[{"x", ",", "y"}], "]"}], " ", 
           RowBox[{"g11", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"a1", "[", 
            RowBox[{"x", ",", "y"}], "]"}], " ", 
           RowBox[{"g12", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b2", " ", 
           RowBox[{"g12", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "-", 
          RowBox[{"b1", " ", 
           RowBox[{"g22", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"g12", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"g11", "[", 
          RowBox[{"x", ",", "y"}], "]"}], " ", 
         RowBox[{"g22", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}]}]]}], ",", 
     RowBox[{
      RowBox[{"b2", " ", 
       RowBox[{"a2", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b2", " ", 
           RowBox[{"g12", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "-", 
          RowBox[{"b1", " ", 
           RowBox[{"g22", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a2", "[", 
            RowBox[{"x", ",", "y"}], "]"}], " ", 
           RowBox[{"g12", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"a1", "[", 
            RowBox[{"x", ",", "y"}], "]"}], " ", 
           RowBox[{"g22", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"g12", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
        RowBox[{
         RowBox[{"g11", "[", 
          RowBox[{"x", ",", "y"}], "]"}], " ", 
         RowBox[{"g22", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.658038555316448*^9, 3.65803864366755*^9, 
  3.658038733015307*^9, 3.6580394017104683`*^9, 3.658040300746632*^9, 
  3.658043665173237*^9, 3.658044022862525*^9, 3.6580441902144547`*^9, 
  3.658046010445113*^9, 3.658046124697727*^9, 3.6581422648985243`*^9, 
  3.658207078968656*^9, 3.658225251104191*^9, 3.65822539892006*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.658038555316448*^9, 3.65803864366755*^9, 
  3.658038733015307*^9, 3.6580394017104683`*^9, 3.658040300746632*^9, 
  3.658043665173237*^9, 3.658044022862525*^9, 3.6580441902144547`*^9, 
  3.658046010445113*^9, 3.658046124697727*^9, 3.6581422648985243`*^9, 
  3.658207078968656*^9, 3.658225251104191*^9, 3.658225398921398*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"b2", " ", 
        RowBox[{"a2", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "-", 
       RowBox[{"b1", " ", 
        RowBox[{"a1", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"b2", " ", 
        RowBox[{"a1", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a2", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "b2", " ", 
           RowBox[{"g12", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "+", 
          RowBox[{"b1", " ", 
           RowBox[{"g22", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"g12", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"b1", " ", 
        RowBox[{"a2", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a1", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b2", " ", 
           RowBox[{"g11", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], "-", 
          RowBox[{"2", " ", "b1", " ", 
           RowBox[{"g12", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"g12", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"b2", " ", 
        RowBox[{"a2", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "-", 
       RowBox[{"b1", " ", 
        RowBox[{"a1", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"g12", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.658038555316448*^9, 3.65803864366755*^9, 
  3.658038733015307*^9, 3.6580394017104683`*^9, 3.658040300746632*^9, 
  3.658043665173237*^9, 3.658044022862525*^9, 3.6580441902144547`*^9, 
  3.658046010445113*^9, 3.658046124697727*^9, 3.6581422648985243`*^9, 
  3.658207078968656*^9, 3.658225251104191*^9, 3.658225398922295*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.658038555316448*^9, 3.65803864366755*^9, 
  3.658038733015307*^9, 3.6580394017104683`*^9, 3.658040300746632*^9, 
  3.658043665173237*^9, 3.658044022862525*^9, 3.6580441902144547`*^9, 
  3.658046010445113*^9, 3.658046124697727*^9, 3.6581422648985243`*^9, 
  3.658207078968656*^9, 3.658225251104191*^9, 3.6582253989233637`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Eigenvalues", "[", "Q", "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sqrt", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Beta]", ".", "v"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"\[Alpha]", ".", "p"}], ")"}]}], "]"}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.6580395841240396`*^9, 3.658039592978024*^9}, {
  3.6580399430932207`*^9, 3.658040009382874*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"a2", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
         RowBox[{"g11", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"a1", "[", 
          RowBox[{"x", ",", "y"}], "]"}], " ", 
         RowBox[{"a2", "[", 
          RowBox[{"x", ",", "y"}], "]"}], " ", 
         RowBox[{"g12", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"a1", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
         RowBox[{"g22", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["b2", "2"], " ", 
         RowBox[{"g11", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}], "+", 
        RowBox[{"b1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "b2", " ", 
            RowBox[{"g12", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{"b1", " ", 
            RowBox[{"g22", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}]}]}], ")"}]}]], 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"g12", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"g11", "[", 
       RowBox[{"x", ",", "y"}], "]"}], " ", 
      RowBox[{"g22", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}]], ",", 
   FractionBox[
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"a2", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
         RowBox[{"g11", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"a1", "[", 
          RowBox[{"x", ",", "y"}], "]"}], " ", 
         RowBox[{"a2", "[", 
          RowBox[{"x", ",", "y"}], "]"}], " ", 
         RowBox[{"g12", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"a1", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
         RowBox[{"g22", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["b2", "2"], " ", 
         RowBox[{"g11", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}], "+", 
        RowBox[{"b1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "b2", " ", 
            RowBox[{"g12", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], "+", 
           RowBox[{"b1", " ", 
            RowBox[{"g22", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}]}]}], ")"}]}]], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"g12", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
     RowBox[{
      RowBox[{"g11", "[", 
       RowBox[{"x", ",", "y"}], "]"}], " ", 
      RowBox[{"g22", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.658039593588819*^9, {3.65803997472761*^9, 3.658040010047799*^9}, 
   3.6580403008431797`*^9, 3.6580436790547523`*^9, 3.658044022974077*^9, 
   3.6580441903344517`*^9, 3.65804601053692*^9, 3.658046124731283*^9, 
   3.658142265028974*^9, 3.65820707908881*^9, 3.658225398949423*^9}],

Cell[BoxData[
 SqrtBox[
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"a2", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
       RowBox[{"g11", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"a1", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{"a2", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{"g12", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a1", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
       RowBox[{"g22", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["b2", "2"], " ", 
       RowBox[{"g11", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "+", 
      RowBox[{"b1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "b2", " ", 
          RowBox[{"g12", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "+", 
         RowBox[{"b1", " ", 
          RowBox[{"g22", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"g12", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
      RowBox[{
       RowBox[{"g11", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{"g22", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}], "2"]]]], "Output",
 CellChangeTimes->{
  3.658039593588819*^9, {3.65803997472761*^9, 3.658040010047799*^9}, 
   3.6580403008431797`*^9, 3.6580436790547523`*^9, 3.658044022974077*^9, 
   3.6580441903344517`*^9, 3.65804601053692*^9, 3.658046124731283*^9, 
   3.658142265028974*^9, 3.65820707908881*^9, 3.658225398950604*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Q2", "=", 
  RowBox[{
   RowBox[{"Q", ".", "Q"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tr", "[", "Q2", "]"}], "-", 
   RowBox[{"2", "*", 
    RowBox[{"\[Alpha]", ".", "p"}], "*", 
    RowBox[{"\[Beta]", ".", "v"}]}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.65803970002232*^9, 3.6580397049748993`*^9}, {
  3.658040035343876*^9, 3.6580400430620937`*^9}, {3.658040199944577*^9, 
  3.658040212278466*^9}, {3.6581429698513517`*^9, 3.658142987007272*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"a2", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
          RowBox[{"g11", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"a1", "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{"a2", "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{"g12", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"a1", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
          RowBox[{"g22", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["b2", "2"], " ", 
          RowBox[{"g11", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "+", 
         RowBox[{"b1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "b2", " ", 
             RowBox[{"g12", "[", 
              RowBox[{"x", ",", "y"}], "]"}]}], "+", 
            RowBox[{"b1", " ", 
             RowBox[{"g22", "[", 
              RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"g12", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
         RowBox[{
          RowBox[{"g11", "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{"g22", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}], "2"]], ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"a2", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
          RowBox[{"g11", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"a1", "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{"a2", "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{"g12", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"a1", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
          RowBox[{"g22", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["b2", "2"], " ", 
          RowBox[{"g11", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "+", 
         RowBox[{"b1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "b2", " ", 
             RowBox[{"g12", "[", 
              RowBox[{"x", ",", "y"}], "]"}]}], "+", 
            RowBox[{"b1", " ", 
             RowBox[{"g22", "[", 
              RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"g12", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
         RowBox[{
          RowBox[{"g11", "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{"g22", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}], "2"]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.658039705611905*^9, {3.658040037854146*^9, 3.658040043611814*^9}, 
   3.65804021273155*^9, 3.658040300886325*^9, 3.658043695501376*^9, 
   3.6580440230038548`*^9, 3.6580441903639393`*^9, 3.658046010615158*^9, 
   3.6580461247640867`*^9, 3.658142265185278*^9, 3.6581429892836246`*^9, 
   3.658207079143403*^9, 3.6582253989848623`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.658039705611905*^9, {3.658040037854146*^9, 3.658040043611814*^9}, 
   3.65804021273155*^9, 3.658040300886325*^9, 3.658043695501376*^9, 
   3.6580440230038548`*^9, 3.6580441903639393`*^9, 3.658046010615158*^9, 
   3.6580461247640867`*^9, 3.658142265185278*^9, 3.6581429892836246`*^9, 
   3.658207079143403*^9, 3.658225398986017*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"flt", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t11", ",", "t12"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"t21", ",", "t22"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"t", "=", 
  RowBox[{
   RowBox[{"gInv", ".", "flt"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g", ".", "t", ".", "gInv"}], "-", 
   RowBox[{"Transpose", "[", "t", "]"}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.658224894669715*^9, 3.658224923668158*^9}, {
  3.658224977206832*^9, 3.6582249900170593`*^9}, {3.6582250560145683`*^9, 
  3.658225061956128*^9}, {3.658225260376176*^9, 3.658225380069569*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"t11", ",", "t12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t21", ",", "t22"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.658224912676504*^9, 3.658224924316374*^9}, {
   3.658224980736862*^9, 3.6582249905731773`*^9}, 3.658225062490878*^9, {
   3.658225360150929*^9, 3.658225398990527*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"t21", " ", 
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "-", 
       RowBox[{"t11", " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"t22", " ", 
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "-", 
       RowBox[{"t12", " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "t21"}], " ", 
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "+", 
       RowBox[{"t11", " ", 
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "t22"}], " ", 
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "+", 
       RowBox[{"t12", " ", 
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.658224912676504*^9, 3.658224924316374*^9}, {
   3.658224980736862*^9, 3.6582249905731773`*^9}, 3.658225062490878*^9, {
   3.658225360150929*^9, 3.6582253990210733`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t12", "-", "t21"}], ")"}], " ", 
       RowBox[{"g12", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"g12", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t12", "-", "t21"}], ")"}], " ", 
       RowBox[{"g11", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"g12", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "t12"}], "+", "t21"}], ")"}], " ", 
       RowBox[{"g22", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"g12", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t12", "-", "t21"}], ")"}], " ", 
       RowBox[{"g12", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"g12", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"g11", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"g22", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.658224912676504*^9, 3.658224924316374*^9}, {
   3.658224980736862*^9, 3.6582249905731773`*^9}, 3.658225062490878*^9, {
   3.658225360150929*^9, 3.6582253990217733`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"R", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"RInv", "=", 
  RowBox[{
   RowBox[{"Inverse", "[", "R", "]"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.658207710045863*^9, 3.658207782489859*^9}, {
  3.6582240801934147`*^9, 3.658224144197361*^9}, {3.658224266702655*^9, 
  3.658224303987962*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.658207790580185*^9, 3.6582241467472467`*^9, {3.658224287273135*^9, 
   3.658224304544889*^9}, 3.658225399056546*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.658207790580185*^9, 3.6582241467472467`*^9, {3.658224287273135*^9, 
   3.658224304544889*^9}, 3.658225399057279*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"flR", "=", 
  RowBox[{
   RowBox[{"g", ".", "R"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.658224256182498*^9, 3.658224263242834*^9}, {
  3.6582243180220137`*^9, 3.658224322872364*^9}, {3.65822574507047*^9, 
  3.658225768620956*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"g11", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"g12", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"g12", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"g11", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"g12", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"g22", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"g22", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"g12", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6582257691498833`*^9}]
}, Open  ]]
},
WindowSize->{1280, 975},
WindowMargins->{{Automatic, 1024}, {Automatic, 0}},
FrontEndVersion->"8.0 for Linux x86 (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 60, 1, 30, "Input"],
Cell[CellGroupData[{
Cell[642, 25, 2411, 67, 164, "Input"],
Cell[3056, 94, 822, 17, 34, "Output"],
Cell[3881, 113, 999, 23, 30, "Output"],
Cell[4883, 138, 2282, 65, 50, "Output"],
Cell[7168, 205, 689, 12, 30, "Output"],
Cell[7860, 219, 897, 20, 41, "Output"],
Cell[8760, 241, 3418, 104, 75, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12215, 350, 795, 23, 88, "Input"],
Cell[13013, 375, 557, 12, 30, "Output"],
Cell[13573, 389, 1809, 56, 59, "Output"],
Cell[15385, 447, 1691, 51, 50, "Output"],
Cell[17079, 500, 1262, 37, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18378, 542, 1978, 55, 164, "Input"],
Cell[20359, 599, 478, 9, 30, "Output"],
Cell[20840, 610, 1478, 44, 50, "Output"],
Cell[22321, 656, 1144, 33, 53, "Output"],
Cell[23468, 691, 480, 9, 30, "Output"],
Cell[23951, 702, 1596, 49, 59, "Output"],
Cell[25550, 753, 1179, 34, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26766, 792, 820, 21, 88, "Input"],
Cell[27589, 815, 5136, 154, 173, "Output"],
Cell[32728, 971, 516, 11, 30, "Output"],
Cell[33247, 984, 3713, 111, 91, "Output"],
Cell[36963, 1097, 375, 5, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37375, 1107, 450, 13, 50, "Input"],
Cell[37828, 1122, 3527, 106, 116, "Output"],
Cell[41358, 1230, 1874, 56, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43269, 1291, 531, 12, 50, "Input"],
Cell[43803, 1305, 3899, 114, 112, "Output"],
Cell[47705, 1421, 384, 6, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48126, 1432, 693, 18, 69, "Input"],
Cell[48822, 1452, 369, 9, 30, "Output"],
Cell[49194, 1463, 2511, 79, 50, "Output"],
Cell[51708, 1544, 2298, 73, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54043, 1622, 668, 19, 50, "Input"],
Cell[54714, 1643, 486, 14, 30, "Output"],
Cell[55203, 1659, 486, 14, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55726, 1678, 271, 6, 30, "Input"],
Cell[56000, 1686, 1367, 43, 50, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
