(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     32978,        829]
NotebookOptionsPosition[     31449,        776]
NotebookOutlinePosition[     31785,        791]
CellTagsIndexPosition[     31742,        788]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"<<", "FormsAndVectors`"}], "\[IndentingNewLine]", 
 RowBox[{"SetOptions", "[", 
  RowBox[{"Simplify", ",", 
   RowBox[{"Trig", "\[Rule]", "True"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.660886582815978*^9, 3.660886585941598*^9}, {
   3.660887555230939*^9, 3.660887557041255*^9}, {3.660887598370351*^9, 
   3.660887625125358*^9}, 3.660887918201621*^9, {3.660888504102601*^9, 
   3.660888512988606*^9}, {3.6608887216183023`*^9, 3.660888722331262*^9}, {
   3.667110559381126*^9, 3.667110579985487*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Assumptions", "\[RuleDelayed]", "$Assumptions"}], ",", 
   RowBox[{"ComplexityFunction", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"ExcludedForms", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"TimeConstraint", "\[Rule]", "300"}], ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"Trig", "\[Rule]", "True"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.66088657564826*^9, 3.660886586594701*^9}, 
   3.660886998907859*^9, 3.6608875697635098`*^9, 3.660887627431375*^9, 
   3.660887925851276*^9, 3.660888525714402*^9, 3.6608887313451138`*^9, 
   3.660889302386355*^9, 3.660893850412037*^9, 3.6608951928650208`*^9, 
   3.660895278811803*^9, 3.660895369105567*^9, 3.660895437533132*^9, 
   3.660897103598856*^9, 3.660897184781262*^9, 3.660904455804981*^9, 
   3.660904502797819*^9, 3.660905303696848*^9, 3.660988365130745*^9, 
   3.660994102021119*^9, 3.667110323684161*^9, {3.667110564782876*^9, 
   3.667110583790764*^9}, 3.670324887116559*^9, 3.680248189799387*^9, 
   3.68024824122826*^9, {3.6811970979279423`*^9, 3.681197109338098*^9}, 
   3.681199242463931*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"cx", "=", 
  RowBox[{"1", "/", "2"}]}], "\[IndentingNewLine]", 
 RowBox[{"cy", "=", 
  RowBox[{"1", "/", "2"}]}], "\[IndentingNewLine]", 
 RowBox[{"cz", "=", 
  RowBox[{"3", "/", "2"}]}], "\[IndentingNewLine]", 
 RowBox[{"X", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"cx", "*", 
     RowBox[{"Sin", "[", "u", "]"}], 
     RowBox[{"Cos", "[", "v", "]"}]}], ",", 
    RowBox[{"cy", "*", 
     RowBox[{"Sin", "[", "u", "]"}], 
     RowBox[{"Sin", "[", "v", "]"}]}], ",", 
    RowBox[{"cz", "*", 
     RowBox[{"Cos", "[", "u", "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"subsR3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "u", "]"}], "\[Rule]", 
      RowBox[{"z", "/", "cz"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "u", "]"}], "\[Rule]", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"Cos", "[", "u", "]"}], "^", "2"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "v", "]"}], "\[Rule]", 
      RowBox[{"x", "/", 
       RowBox[{"(", 
        RowBox[{"cx", "*", 
         RowBox[{"Sin", "[", "u", "]"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "v", "]"}], "\[Rule]", 
      RowBox[{"y", "/", 
       RowBox[{"(", 
        RowBox[{"cy", "*", 
         RowBox[{"Sin", "[", "u", "]"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"2", "*", "u"}], "]"}], "->", 
      RowBox[{"2", "*", 
       RowBox[{"Sin", "[", "u", "]"}], "*", 
       RowBox[{"Cos", "[", "u", "]"}]}]}]}], "}"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"TrigSub", "[", 
     RowBox[{"expr_", ",", "subs_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{
       RowBox[{"SetSystemOptions", "[", 
        RowBox[{"\"\<SimplificationOptions\>\"", "\[Rule]", 
         RowBox[{"\"\<AutosimplifyTrigs\>\"", "\[Rule]", "False"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TrigExpand", "[", 
           RowBox[{"TrigFactor", "[", 
            RowBox[{
             RowBox[{"TrigExpand", "[", "expr", "]"}], "//.", "subs"}], "]"}],
            "]"}], "//.", "subs"}], ")"}], "//", "Simplify"}]}]}], "]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrigSub", "[", 
   RowBox[{"expr_", ",", "subs_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{"SetOptions", "[", 
      RowBox[{"Simplify", ",", 
       RowBox[{"Trig", "\[Rule]", "False"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t\t\t\t\t\t", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"TrigExpand", "[", 
         RowBox[{"TrigFactor", "[", 
          RowBox[{
           RowBox[{"TrigExpand", "[", "expr", "]"}], "//.", "subs"}], "]"}], 
         "]"}], "//.", "subs"}], ")"}], "//", "Simplify"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrigSub", "[", "expr_", "]"}], ":=", 
  RowBox[{"TrigSub", "[", 
   RowBox[{"expr", ",", "subsR3"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Simplify", ",", 
    RowBox[{"Trig", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"zSub", "=", 
  RowBox[{"{", 
   RowBox[{"z", "\[Rule]", 
    RowBox[{"cz", "*", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"y", "^", "2"}], "/", 
        RowBox[{"cy", "^", "2"}]}], "-", 
       RowBox[{
        RowBox[{"x", "^", "2"}], "/", 
        RowBox[{"cx", "^", "2"}]}]}], "]"}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"g", "=", 
  RowBox[{
   RowBox[{"MetricFromPara", "[", 
    RowBox[{"X", ",", "u", ",", "v"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"gInv", "=", 
  RowBox[{
   RowBox[{"Inverse", "[", "g", "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"vol", "=", " ", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{"Det", "[", "g", "]"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{"0", "<", "u"}], "&&", 
   RowBox[{"u", "<", "\[Pi]"}], "&&", 
   RowBox[{"0", "\[LessEqual]", "v"}], "&&", 
   RowBox[{"v", "<", 
    RowBox[{"2", "\[Pi]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"ParametricPlot3D", "[", 
    RowBox[{"X", ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6608865944797497`*^9, 3.66088683904193*^9}, {
   3.660886882978071*^9, 3.660886899571871*^9}, {3.6608869819063683`*^9, 
   3.660887110713608*^9}, {3.660887154729331*^9, 3.6608871685584993`*^9}, {
   3.6608873108524723`*^9, 3.6608873190168667`*^9}, {3.660887581401524*^9, 
   3.660887583226614*^9}, {3.6608889927598877`*^9, 3.660889038596698*^9}, {
   3.6608891181212873`*^9, 3.660889226636952*^9}, {3.660889259818615*^9, 
   3.660889269647498*^9}, {3.660889406135416*^9, 3.660889415496881*^9}, {
   3.660889486908524*^9, 3.660889487819126*^9}, {3.6608897487336197`*^9, 
   3.660889789463763*^9}, {3.660892184209272*^9, 3.660892187134685*^9}, {
   3.660894667116169*^9, 3.660894676100037*^9}, {3.6608953984885406`*^9, 
   3.660895406081746*^9}, {3.6609025856166763`*^9, 3.660902589098558*^9}, {
   3.660903005791647*^9, 3.660903018262866*^9}, {3.6609030603474293`*^9, 
   3.6609030624674788`*^9}, 3.660903280239798*^9, {3.660904121075465*^9, 
   3.660904176958231*^9}, {3.660904491623623*^9, 3.66090449465895*^9}, {
   3.661061501547101*^9, 3.661061525259791*^9}, {3.661061604607356*^9, 
   3.661061637765761*^9}, {3.680248182381956*^9, 3.680248182656698*^9}, {
   3.680248223504353*^9, 3.680248226852333*^9}, {3.6802532294101343`*^9, 
   3.680253261544463*^9}, 3.6811992308695507`*^9, {3.6811992744596167`*^9, 
   3.681199308384294*^9}, {3.6812018458002853`*^9, 3.681201876523459*^9}}],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{
  3.660886846334614*^9, 3.660886901116037*^9, 3.660886998927127*^9, 
   3.6608871166819143`*^9, 3.660887171974408*^9, {3.6608875697920227`*^9, 
   3.6608875840999727`*^9}, 3.660887632709969*^9, 3.660887925955917*^9, 
   3.660888525737656*^9, 3.66088873135163*^9, 3.6608893047796373`*^9, 
   3.660889417432925*^9, {3.660889775540924*^9, 3.66088979073361*^9}, 
   3.660892187804604*^9, 3.660893850524569*^9, 3.660894676892153*^9, 
   3.660895192892469*^9, 3.6608952788184958`*^9, 3.660895369142407*^9, {
   3.660895419983614*^9, 3.660895437571154*^9}, 3.660897103626083*^9, 
   3.6608971848062696`*^9, 3.660902590151121*^9, 3.660903025930375*^9, 
   3.66090306333416*^9, 3.660903281054262*^9, {3.660904152304862*^9, 
   3.660904177772046*^9}, 3.660904455834334*^9, 3.660904502802932*^9, 
   3.660905303730982*^9, 3.660988365172655*^9, 3.660994102081834*^9, 
   3.661061641175125*^9, 3.6671103237663*^9, {3.667110564889552*^9, 
   3.66711058390481*^9}, 3.6703248872390347`*^9, 3.680248189857341*^9, 
   3.6802482412400093`*^9, 3.680253265448007*^9, {3.68119709805584*^9, 
   3.681197109445327*^9}, 3.681199242493346*^9, 3.6811993100190277`*^9, 
   3.681201878982791*^9}],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{
  3.660886846334614*^9, 3.660886901116037*^9, 3.660886998927127*^9, 
   3.6608871166819143`*^9, 3.660887171974408*^9, {3.6608875697920227`*^9, 
   3.6608875840999727`*^9}, 3.660887632709969*^9, 3.660887925955917*^9, 
   3.660888525737656*^9, 3.66088873135163*^9, 3.6608893047796373`*^9, 
   3.660889417432925*^9, {3.660889775540924*^9, 3.66088979073361*^9}, 
   3.660892187804604*^9, 3.660893850524569*^9, 3.660894676892153*^9, 
   3.660895192892469*^9, 3.6608952788184958`*^9, 3.660895369142407*^9, {
   3.660895419983614*^9, 3.660895437571154*^9}, 3.660897103626083*^9, 
   3.6608971848062696`*^9, 3.660902590151121*^9, 3.660903025930375*^9, 
   3.66090306333416*^9, 3.660903281054262*^9, {3.660904152304862*^9, 
   3.660904177772046*^9}, 3.660904455834334*^9, 3.660904502802932*^9, 
   3.660905303730982*^9, 3.660988365172655*^9, 3.660994102081834*^9, 
   3.661061641175125*^9, 3.6671103237663*^9, {3.667110564889552*^9, 
   3.66711058390481*^9}, 3.6703248872390347`*^9, 3.680248189857341*^9, 
   3.6802482412400093`*^9, 3.680253265448007*^9, {3.68119709805584*^9, 
   3.681197109445327*^9}, 3.681199242493346*^9, 3.6811993100190277`*^9, 
   3.681201878983932*^9}],

Cell[BoxData[
 FractionBox["3", "2"]], "Output",
 CellChangeTimes->{
  3.660886846334614*^9, 3.660886901116037*^9, 3.660886998927127*^9, 
   3.6608871166819143`*^9, 3.660887171974408*^9, {3.6608875697920227`*^9, 
   3.6608875840999727`*^9}, 3.660887632709969*^9, 3.660887925955917*^9, 
   3.660888525737656*^9, 3.66088873135163*^9, 3.6608893047796373`*^9, 
   3.660889417432925*^9, {3.660889775540924*^9, 3.66088979073361*^9}, 
   3.660892187804604*^9, 3.660893850524569*^9, 3.660894676892153*^9, 
   3.660895192892469*^9, 3.6608952788184958`*^9, 3.660895369142407*^9, {
   3.660895419983614*^9, 3.660895437571154*^9}, 3.660897103626083*^9, 
   3.6608971848062696`*^9, 3.660902590151121*^9, 3.660903025930375*^9, 
   3.66090306333416*^9, 3.660903281054262*^9, {3.660904152304862*^9, 
   3.660904177772046*^9}, 3.660904455834334*^9, 3.660904502802932*^9, 
   3.660905303730982*^9, 3.660988365172655*^9, 3.660994102081834*^9, 
   3.661061641175125*^9, 3.6671103237663*^9, {3.667110564889552*^9, 
   3.66711058390481*^9}, 3.6703248872390347`*^9, 3.680248189857341*^9, 
   3.6802482412400093`*^9, 3.680253265448007*^9, {3.68119709805584*^9, 
   3.681197109445327*^9}, 3.681199242493346*^9, 3.6811993100190277`*^9, 
   3.681201878984869*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"Cos", "[", "v", "]"}], " ", 
    RowBox[{"Sin", "[", "u", "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"Sin", "[", "u", "]"}], " ", 
    RowBox[{"Sin", "[", "v", "]"}]}], ",", 
   FractionBox[
    RowBox[{"3", " ", 
     RowBox[{"Cos", "[", "u", "]"}]}], "2"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.660886846334614*^9, 3.660886901116037*^9, 3.660886998927127*^9, 
   3.6608871166819143`*^9, 3.660887171974408*^9, {3.6608875697920227`*^9, 
   3.6608875840999727`*^9}, 3.660887632709969*^9, 3.660887925955917*^9, 
   3.660888525737656*^9, 3.66088873135163*^9, 3.6608893047796373`*^9, 
   3.660889417432925*^9, {3.660889775540924*^9, 3.66088979073361*^9}, 
   3.660892187804604*^9, 3.660893850524569*^9, 3.660894676892153*^9, 
   3.660895192892469*^9, 3.6608952788184958`*^9, 3.660895369142407*^9, {
   3.660895419983614*^9, 3.660895437571154*^9}, 3.660897103626083*^9, 
   3.6608971848062696`*^9, 3.660902590151121*^9, 3.660903025930375*^9, 
   3.66090306333416*^9, 3.660903281054262*^9, {3.660904152304862*^9, 
   3.660904177772046*^9}, 3.660904455834334*^9, 3.660904502802932*^9, 
   3.660905303730982*^9, 3.660988365172655*^9, 3.660994102081834*^9, 
   3.661061641175125*^9, 3.6671103237663*^9, {3.667110564889552*^9, 
   3.66711058390481*^9}, 3.6703248872390347`*^9, 3.680248189857341*^9, 
   3.6802482412400093`*^9, 3.680253265448007*^9, {3.68119709805584*^9, 
   3.681197109445327*^9}, 3.681199242493346*^9, 3.6811993100190277`*^9, 
   3.681201878985715*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "u", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", "z"}], "3"]}], ",", 
   RowBox[{
    RowBox[{"Sin", "[", "u", "]"}], "\[Rule]", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox[
       RowBox[{"Cos", "[", "u", "]"}], "2"]}]]}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", "v", "]"}], "\[Rule]", 
    RowBox[{"2", " ", "x", " ", 
     RowBox[{"Csc", "[", "u", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"Sin", "[", "v", "]"}], "\[Rule]", 
    RowBox[{"2", " ", "y", " ", 
     RowBox[{"Csc", "[", "u", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "u"}], "]"}], "\[Rule]", 
    RowBox[{"2", " ", 
     RowBox[{"Cos", "[", "u", "]"}], " ", 
     RowBox[{"Sin", "[", "u", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.660886846334614*^9, 3.660886901116037*^9, 3.660886998927127*^9, 
   3.6608871166819143`*^9, 3.660887171974408*^9, {3.6608875697920227`*^9, 
   3.6608875840999727`*^9}, 3.660887632709969*^9, 3.660887925955917*^9, 
   3.660888525737656*^9, 3.66088873135163*^9, 3.6608893047796373`*^9, 
   3.660889417432925*^9, {3.660889775540924*^9, 3.66088979073361*^9}, 
   3.660892187804604*^9, 3.660893850524569*^9, 3.660894676892153*^9, 
   3.660895192892469*^9, 3.6608952788184958`*^9, 3.660895369142407*^9, {
   3.660895419983614*^9, 3.660895437571154*^9}, 3.660897103626083*^9, 
   3.6608971848062696`*^9, 3.660902590151121*^9, 3.660903025930375*^9, 
   3.66090306333416*^9, 3.660903281054262*^9, {3.660904152304862*^9, 
   3.660904177772046*^9}, 3.660904455834334*^9, 3.660904502802932*^9, 
   3.660905303730982*^9, 3.660988365172655*^9, 3.660994102081834*^9, 
   3.661061641175125*^9, 3.6671103237663*^9, {3.667110564889552*^9, 
   3.66711058390481*^9}, 3.6703248872390347`*^9, 3.680248189857341*^9, 
   3.6802482412400093`*^9, 3.680253265448007*^9, {3.68119709805584*^9, 
   3.681197109445327*^9}, 3.681199242493346*^9, 3.6811993100190277`*^9, 
   3.681201878986511*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"z", "\[Rule]", 
   RowBox[{
    FractionBox["3", "2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["x", "2"]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["y", "2"]}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.660886846334614*^9, 3.660886901116037*^9, 3.660886998927127*^9, 
   3.6608871166819143`*^9, 3.660887171974408*^9, {3.6608875697920227`*^9, 
   3.6608875840999727`*^9}, 3.660887632709969*^9, 3.660887925955917*^9, 
   3.660888525737656*^9, 3.66088873135163*^9, 3.6608893047796373`*^9, 
   3.660889417432925*^9, {3.660889775540924*^9, 3.66088979073361*^9}, 
   3.660892187804604*^9, 3.660893850524569*^9, 3.660894676892153*^9, 
   3.660895192892469*^9, 3.6608952788184958`*^9, 3.660895369142407*^9, {
   3.660895419983614*^9, 3.660895437571154*^9}, 3.660897103626083*^9, 
   3.6608971848062696`*^9, 3.660902590151121*^9, 3.660903025930375*^9, 
   3.66090306333416*^9, 3.660903281054262*^9, {3.660904152304862*^9, 
   3.660904177772046*^9}, 3.660904455834334*^9, 3.660904502802932*^9, 
   3.660905303730982*^9, 3.660988365172655*^9, 3.660994102081834*^9, 
   3.661061641175125*^9, 3.6671103237663*^9, {3.667110564889552*^9, 
   3.66711058390481*^9}, 3.6703248872390347`*^9, 3.680248189857341*^9, 
   3.6802482412400093`*^9, 3.680253265448007*^9, {3.68119709805584*^9, 
   3.681197109445327*^9}, 3.681199242493346*^9, 3.6811993100190277`*^9, 
   3.681201878987125*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["5", "4"], "-", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "u"}], "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"Sin", "[", "u", "]"}], "2"], "4"]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.660886846334614*^9, 3.660886901116037*^9, 3.660886998927127*^9, 
   3.6608871166819143`*^9, 3.660887171974408*^9, {3.6608875697920227`*^9, 
   3.6608875840999727`*^9}, 3.660887632709969*^9, 3.660887925955917*^9, 
   3.660888525737656*^9, 3.66088873135163*^9, 3.6608893047796373`*^9, 
   3.660889417432925*^9, {3.660889775540924*^9, 3.66088979073361*^9}, 
   3.660892187804604*^9, 3.660893850524569*^9, 3.660894676892153*^9, 
   3.660895192892469*^9, 3.6608952788184958`*^9, 3.660895369142407*^9, {
   3.660895419983614*^9, 3.660895437571154*^9}, 3.660897103626083*^9, 
   3.6608971848062696`*^9, 3.660902590151121*^9, 3.660903025930375*^9, 
   3.66090306333416*^9, 3.660903281054262*^9, {3.660904152304862*^9, 
   3.660904177772046*^9}, 3.660904455834334*^9, 3.660904502802932*^9, 
   3.660905303730982*^9, 3.660988365172655*^9, 3.660994102081834*^9, 
   3.661061641175125*^9, 3.6671103237663*^9, {3.667110564889552*^9, 
   3.66711058390481*^9}, 3.6703248872390347`*^9, 3.680248189857341*^9, 
   3.6802482412400093`*^9, 3.680253265448007*^9, {3.68119709805584*^9, 
   3.681197109445327*^9}, 3.681199242493346*^9, 3.6811993100190277`*^9, 
   3.681201878987739*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["4", 
       RowBox[{
        RowBox[{"-", "5"}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "u"}], "]"}]}]}]]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"Csc", "[", "u", "]"}], "2"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.660886846334614*^9, 3.660886901116037*^9, 3.660886998927127*^9, 
   3.6608871166819143`*^9, 3.660887171974408*^9, {3.6608875697920227`*^9, 
   3.6608875840999727`*^9}, 3.660887632709969*^9, 3.660887925955917*^9, 
   3.660888525737656*^9, 3.66088873135163*^9, 3.6608893047796373`*^9, 
   3.660889417432925*^9, {3.660889775540924*^9, 3.66088979073361*^9}, 
   3.660892187804604*^9, 3.660893850524569*^9, 3.660894676892153*^9, 
   3.660895192892469*^9, 3.6608952788184958`*^9, 3.660895369142407*^9, {
   3.660895419983614*^9, 3.660895437571154*^9}, 3.660897103626083*^9, 
   3.6608971848062696`*^9, 3.660902590151121*^9, 3.660903025930375*^9, 
   3.66090306333416*^9, 3.660903281054262*^9, {3.660904152304862*^9, 
   3.660904177772046*^9}, 3.660904455834334*^9, 3.660904502802932*^9, 
   3.660905303730982*^9, 3.660988365172655*^9, 3.660994102081834*^9, 
   3.661061641175125*^9, 3.6671103237663*^9, {3.667110564889552*^9, 
   3.66711058390481*^9}, 3.6703248872390347`*^9, 3.680248189857341*^9, 
   3.6802482412400093`*^9, 3.680253265448007*^9, {3.68119709805584*^9, 
   3.681197109445327*^9}, 3.681199242493346*^9, 3.6811993100190277`*^9, 
   3.681201878988323*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  SqrtBox[
   RowBox[{"5", "-", 
    RowBox[{"4", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "u"}], "]"}]}]}]], " ", 
  RowBox[{"Sin", "[", "u", "]"}]}]], "Output",
 CellChangeTimes->{
  3.660886846334614*^9, 3.660886901116037*^9, 3.660886998927127*^9, 
   3.6608871166819143`*^9, 3.660887171974408*^9, {3.6608875697920227`*^9, 
   3.6608875840999727`*^9}, 3.660887632709969*^9, 3.660887925955917*^9, 
   3.660888525737656*^9, 3.66088873135163*^9, 3.6608893047796373`*^9, 
   3.660889417432925*^9, {3.660889775540924*^9, 3.66088979073361*^9}, 
   3.660892187804604*^9, 3.660893850524569*^9, 3.660894676892153*^9, 
   3.660895192892469*^9, 3.6608952788184958`*^9, 3.660895369142407*^9, {
   3.660895419983614*^9, 3.660895437571154*^9}, 3.660897103626083*^9, 
   3.6608971848062696`*^9, 3.660902590151121*^9, 3.660903025930375*^9, 
   3.66090306333416*^9, 3.660903281054262*^9, {3.660904152304862*^9, 
   3.660904177772046*^9}, 3.660904455834334*^9, 3.660904502802932*^9, 
   3.660905303730982*^9, 3.660988365172655*^9, 3.660994102081834*^9, 
   3.661061641175125*^9, 3.6671103237663*^9, {3.667110564889552*^9, 
   3.66711058390481*^9}, 3.6703248872390347`*^9, 3.680248189857341*^9, 
   3.6802482412400093`*^9, 3.680253265448007*^9, {3.68119709805584*^9, 
   3.681197109445327*^9}, 3.681199242493346*^9, 3.6811993100190277`*^9, 
   3.68120187898892*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"0", "<", "u"}], "&&", 
  RowBox[{"u", "<", "\[Pi]"}], "&&", 
  RowBox[{"0", "\[LessEqual]", "v"}], "&&", 
  RowBox[{"v", "<", 
   RowBox[{"2", " ", "\[Pi]"}]}]}]], "Output",
 CellChangeTimes->{
  3.660886846334614*^9, 3.660886901116037*^9, 3.660886998927127*^9, 
   3.6608871166819143`*^9, 3.660887171974408*^9, {3.6608875697920227`*^9, 
   3.6608875840999727`*^9}, 3.660887632709969*^9, 3.660887925955917*^9, 
   3.660888525737656*^9, 3.66088873135163*^9, 3.6608893047796373`*^9, 
   3.660889417432925*^9, {3.660889775540924*^9, 3.66088979073361*^9}, 
   3.660892187804604*^9, 3.660893850524569*^9, 3.660894676892153*^9, 
   3.660895192892469*^9, 3.6608952788184958`*^9, 3.660895369142407*^9, {
   3.660895419983614*^9, 3.660895437571154*^9}, 3.660897103626083*^9, 
   3.6608971848062696`*^9, 3.660902590151121*^9, 3.660903025930375*^9, 
   3.66090306333416*^9, 3.660903281054262*^9, {3.660904152304862*^9, 
   3.660904177772046*^9}, 3.660904455834334*^9, 3.660904502802932*^9, 
   3.660905303730982*^9, 3.660988365172655*^9, 3.660994102081834*^9, 
   3.661061641175125*^9, 3.6671103237663*^9, {3.667110564889552*^9, 
   3.66711058390481*^9}, 3.6703248872390347`*^9, 3.680248189857341*^9, 
   3.6802482412400093`*^9, 3.680253265448007*^9, {3.68119709805584*^9, 
   3.681197109445327*^9}, 3.681199242493346*^9, 3.6811993100190277`*^9, 
   3.681201878989419*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Xu", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"X", ",", "u"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"Xv", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"X", ",", "v"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nuDirection", "=", 
   RowBox[{
    RowBox[{"Cross", "[", 
     RowBox[{"Xu", ",", "Xv"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"nu", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"nuDirection", ".", "nuDirection"}], "]"}]}], ")"}], "*", 
    "nuDirection"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"LC", "=", 
  RowBox[{
   RowBox[{"vol", "*", 
    RowBox[{"LeviCivitaTensor", "[", "2", "]"}]}], "//", 
   "Normal"}]}]}], "Input",
 CellChangeTimes->{{3.667110193327025*^9, 3.667110226677516*^9}, {
  3.667111895578683*^9, 3.667111907536353*^9}, {3.6703249660976877`*^9, 
  3.6703249681986*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"Cos", "[", "u", "]"}], " ", 
    RowBox[{"Cos", "[", "v", "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"Cos", "[", "u", "]"}], " ", 
    RowBox[{"Sin", "[", "v", "]"}]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"3", " ", 
      RowBox[{"Sin", "[", "u", "]"}]}], "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6671103244618177`*^9, {3.6671105651360197`*^9, 3.667110584371592*^9}, {
   3.667111903513586*^9, 3.667111908356413*^9}, 3.670324887693677*^9, 
   3.670324969598701*^9, 3.680248191027534*^9, 3.6802482415786037`*^9, {
   3.681197098352949*^9, 3.681197109890375*^9}, 3.681199242562358*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", 
    RowBox[{"Sin", "[", "u", "]"}], " ", 
    RowBox[{"Sin", "[", "v", "]"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"Cos", "[", "v", "]"}], " ", 
    RowBox[{"Sin", "[", "u", "]"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6671103244618177`*^9, {3.6671105651360197`*^9, 3.667110584371592*^9}, {
   3.667111903513586*^9, 3.667111908356413*^9}, 3.670324887693677*^9, 
   3.670324969598701*^9, 3.680248191027534*^9, 3.6802482415786037`*^9, {
   3.681197098352949*^9, 3.681197109890375*^9}, 3.681199242563423*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"3", " ", 
     RowBox[{"Cos", "[", "v", "]"}], " ", 
     RowBox[{"Sin", "[", "u", "]"}]}], 
    SqrtBox[
     RowBox[{"5", "-", 
      RowBox[{"4", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "u"}], "]"}]}]}]]], ",", 
   FractionBox[
    RowBox[{"3", " ", 
     RowBox[{"Sin", "[", "u", "]"}], " ", 
     RowBox[{"Sin", "[", "v", "]"}]}], 
    SqrtBox[
     RowBox[{"5", "-", 
      RowBox[{"4", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "u"}], "]"}]}]}]]], ",", 
   FractionBox[
    RowBox[{"Cos", "[", "u", "]"}], 
    SqrtBox[
     RowBox[{"5", "-", 
      RowBox[{"4", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "u"}], "]"}]}]}]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6671103244618177`*^9, {3.6671105651360197`*^9, 3.667110584371592*^9}, {
   3.667111903513586*^9, 3.667111908356413*^9}, 3.670324887693677*^9, 
   3.670324969598701*^9, 3.680248191027534*^9, 3.6802482415786037`*^9, {
   3.681197098352949*^9, 3.681197109890375*^9}, 3.6811992426215487`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      SqrtBox[
       RowBox[{"5", "-", 
        RowBox[{"4", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "u"}], "]"}]}]}]], " ", 
      RowBox[{"Sin", "[", "u", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "4"]}], " ", 
      SqrtBox[
       RowBox[{"5", "-", 
        RowBox[{"4", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "u"}], "]"}]}]}]], " ", 
      RowBox[{"Sin", "[", "u", "]"}]}], ",", "0"}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.6671103244618177`*^9, {3.6671105651360197`*^9, 3.667110584371592*^9}, {
   3.667111903513586*^9, 3.667111908356413*^9}, 3.670324887693677*^9, 
   3.670324969598701*^9, 3.680248191027534*^9, 3.6802482415786037`*^9, {
   3.681197098352949*^9, 3.681197109890375*^9}, 3.6811992426230173`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"K", "=", 
  RowBox[{
   RowBox[{"GaussCurvFromMetric", "[", 
    RowBox[{"u", ",", "v", ",", "g"}], "]"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.680248309870425*^9, 3.680248330835019*^9}}],

Cell[BoxData[
 FractionBox["36", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"5", "-", 
     RowBox[{"4", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "u"}], "]"}]}]}], ")"}], "2"]]], "Output",
 CellChangeTimes->{
  3.680248332195212*^9, {3.681197098843721*^9, 3.681197110342367*^9}, 
   3.681199242649816*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"KXYZ", "=", 
  RowBox[{
   RowBox[{"TrigSub", "[", 
    RowBox[{"K", ",", "subsR3"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"CPPExpression", "[", "KXYZ", "]"}]}], "Input",
 CellChangeTimes->{{3.680248348909525*^9, 3.680248396260354*^9}, {
  3.680248480343927*^9, 3.680248491032053*^9}}],

Cell[BoxData[
 FractionBox["2916", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"81", "-", 
     RowBox[{"32", " ", 
      SuperscriptBox["z", "2"]}]}], ")"}], "2"]]], "Output",
 CellChangeTimes->{{3.6802483907527103`*^9, 3.680248398200281*^9}, 
   3.6802484955264397`*^9, {3.681197099080688*^9, 3.6811971105837927`*^9}, 
   3.681199242678853*^9}],

Cell[BoxData["\<\"2916./std::pow(81. - 32.*std::pow(z,2),2)\"\>"], "Output",
 CellChangeTimes->{{3.6802483907527103`*^9, 3.680248398200281*^9}, 
   3.6802484955264397`*^9, {3.681197099080688*^9, 3.6811971105837927`*^9}, 
   3.681199242679471*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"KXYZ", "//.", "zSub"}], ")"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6802488377599287`*^9, 3.680248857977779*^9}, {
  3.68024889073038*^9, 3.68024891997147*^9}}],

Cell[BoxData[
 FractionBox["36", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"32", " ", 
      SuperscriptBox["x", "2"]}], "+", 
     RowBox[{"32", " ", 
      SuperscriptBox["y", "2"]}]}], ")"}], "2"]]], "Output",
 CellChangeTimes->{{3.680248844470807*^9, 3.680248858581778*^9}, {
   3.68024889239929*^9, 3.680248921036756*^9}, {3.6811970992271957`*^9, 
   3.6811971107694397`*^9}, 3.6811992427059307`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "vol"}], "//", "Simplify"}], 
      ",", "u", ",", "v"}], "]"}]}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6811975620484867`*^9, 3.681197602874525*^9}, {
  3.6811976869938393`*^9, 3.681197690313558*^9}, {3.681199318363916*^9, 
  3.681199378986915*^9}, {3.681199415917965*^9, 3.681199416954691*^9}, {
  3.68119945478681*^9, 3.681199457882201*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "64"], " ", "v", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"5", " ", 
     SqrtBox["5"]}], "-", 
    RowBox[{"5", " ", 
     SqrtBox[
      RowBox[{"5", "-", 
       RowBox[{"4", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "u"}], "]"}]}]}]]}], "+", 
    RowBox[{"4", " ", 
     SqrtBox[
      RowBox[{"5", "-", 
       RowBox[{"4", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "u"}], "]"}]}]}]], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "u"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.681197681391466*^9, 3.681199177989468*^9, 
  3.681199242776476*^9, 3.6811993819862003`*^9, 3.681199417944695*^9, 
  3.681199458711341*^9}]
}, Open  ]]
},
WindowSize->{1680, 1001},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Linux x86 (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 528, 9, 50, "Input"],
Cell[1110, 33, 1161, 20, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2308, 58, 6107, 160, 335, "Input"],
Cell[8418, 220, 1236, 19, 47, "Output"],
Cell[9657, 241, 1236, 19, 47, "Output"],
Cell[10896, 262, 1236, 19, 47, "Output"],
Cell[12135, 283, 1593, 31, 47, "Output"],
Cell[13731, 316, 2016, 44, 47, "Output"],
Cell[15750, 362, 1476, 28, 48, "Output"],
Cell[17229, 392, 1561, 32, 50, "Output"],
Cell[18793, 426, 1643, 34, 50, "Output"],
Cell[20439, 462, 1419, 26, 47, "Output"],
Cell[21861, 490, 1396, 24, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23294, 519, 1030, 32, 107, "Input"],
Cell[24327, 553, 738, 19, 48, "Output"],
Cell[25068, 574, 657, 16, 47, "Output"],
Cell[25728, 592, 1089, 32, 53, "Output"],
Cell[26820, 626, 981, 29, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27838, 660, 228, 5, 30, "Input"],
Cell[28069, 667, 327, 10, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28433, 682, 339, 8, 50, "Input"],
Cell[28775, 692, 350, 9, 54, "Output"],
Cell[29128, 703, 246, 3, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29411, 711, 231, 5, 30, "Input"],
Cell[29645, 718, 435, 11, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30117, 734, 582, 14, 30, "Input"],
Cell[30702, 750, 731, 23, 47, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
