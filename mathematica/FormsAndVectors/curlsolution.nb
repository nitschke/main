(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     67032,       1558]
NotebookOptionsPosition[     63807,       1452]
NotebookOutlinePosition[     64145,       1467]
CellTagsIndexPosition[     64102,       1464]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", "FormsAndVectors`"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{"Simplify", ",", 
   RowBox[{"Trig", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.650096312824243*^9, 3.650096327734728*^9}, {
  3.650096366079196*^9, 3.6500963682909327`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Assumptions", "\[RuleDelayed]", "$Assumptions"}], ",", 
   RowBox[{"ComplexityFunction", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"ExcludedForms", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"TimeConstraint", "\[Rule]", "300"}], ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"Trig", "\[Rule]", "True"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6500963312127132`*^9, 3.650096371339423*^9, 3.6500970042750883`*^9, 
   3.650097603291284*^9, 3.650097687238997*^9, {3.6500981254477253`*^9, 
   3.650098142105133*^9}, 3.650098179357567*^9, 3.650098229095791*^9, 
   3.65009830679305*^9, {3.650098358506681*^9, 3.650098377726955*^9}, 
   3.65009841931207*^9, 3.65009881682145*^9, 3.650098890612418*^9, 
   3.650098983477037*^9, 3.650099174003992*^9, 3.650099326457315*^9, 
   3.650099761787538*^9, 3.650099833293168*^9, 3.65010024424098*^9, 
   3.650101865456571*^9, 3.650101967028948*^9, 3.650102167424604*^9, 
   3.650284783217351*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"XG", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"u", ",", "v"}], "]"}], ",", 
     RowBox[{"y", "[", 
      RowBox[{"u", ",", "v"}], "]"}], ",", 
     RowBox[{"z", "[", 
      RowBox[{"u", ",", "v"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"0", "<", "u"}], "&&", 
    RowBox[{"u", "<", "\[Pi]"}], "&&", 
    RowBox[{"0", "\[LessEqual]", "v"}], "&&", 
    RowBox[{"v", "<", 
     RowBox[{"2", "\[Pi]"}]}], "&&", 
    RowBox[{"t", ">", "0"}], "&&", 
    RowBox[{"v", ">", "0"}], "&&", 
    RowBox[{"v", "<", 
     RowBox[{"2", "\[Pi]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XS", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "u", "]"}], 
       RowBox[{"Cos", "[", "v", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "u", "]"}], 
       RowBox[{"Sin", "[", "v", "]"}]}], ",", 
      RowBox[{"Cos", "[", "u", "]"}]}], "}"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"X", "=", " ", "XS"}], "\[IndentingNewLine]", 
 RowBox[{"g", "=", 
  RowBox[{
   RowBox[{"MetricFromPara", "[", 
    RowBox[{"X", ",", "u", ",", "v"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"gInv", "=", 
  RowBox[{
   RowBox[{"Inverse", "[", "g", "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"vol", "=", " ", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{"Det", "[", "g", "]"}], "]"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.6475995726026697`*^9, 3.6475996509565897`*^9}, {
   3.647669566302725*^9, 3.6476695796830797`*^9}, {3.647669623539269*^9, 
   3.647669646235971*^9}, {3.647670164333605*^9, 3.647670167892599*^9}, {
   3.647673137482155*^9, 3.647673144476416*^9}, {3.647844376748241*^9, 
   3.647844384353878*^9}, 3.6478445456276712`*^9, {3.647855049088532*^9, 
   3.6478550692489233`*^9}, {3.647855906311675*^9, 3.6478559064226017`*^9}, {
   3.647855945046893*^9, 3.647855951743373*^9}, {3.647855990527796*^9, 
   3.647856001980852*^9}, {3.64785688265442*^9, 3.647856896706975*^9}, {
   3.647857095992386*^9, 3.6478571274940977`*^9}, {3.647857208468759*^9, 
   3.647857215450549*^9}, {3.647859783622176*^9, 3.647859822207148*^9}, {
   3.647860184816811*^9, 3.6478601938744183`*^9}, {3.647860416032422*^9, 
   3.647860433818429*^9}, {3.6478606066069202`*^9, 3.647860612149726*^9}, {
   3.647860669627512*^9, 3.6478607114309464`*^9}, {3.6479235007018948`*^9, 
   3.647923518594408*^9}, {3.6479355699102993`*^9, 3.6479355730649633`*^9}, {
   3.64879616784951*^9, 3.648796210879608*^9}, {3.648801052145424*^9, 
   3.648801054077285*^9}, {3.648975471330145*^9, 3.648975494552477*^9}, {
   3.648975593661435*^9, 3.648975612917602*^9}, {3.6500061473364277`*^9, 
   3.6500061764674397`*^9}, {3.650096121126696*^9, 3.6500961364984007`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "v", "]"}], " ", 
    RowBox[{"Sin", "[", "u", "]"}]}], ",", 
   RowBox[{
    RowBox[{"Sin", "[", "u", "]"}], " ", 
    RowBox[{"Sin", "[", "v", "]"}]}], ",", 
   RowBox[{"Cos", "[", "u", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.647599652092414*^9, 3.6475999016899223`*^9, 3.647600101883606*^9, 
   3.647602229821965*^9, 3.6476024806888857`*^9, 3.64766790397863*^9, 
   3.647669526524805*^9, 3.6476696492977047`*^9, 3.647670171816669*^9, 
   3.647673094983068*^9, {3.647673145598823*^9, 3.6476731488412733`*^9}, 
   3.647842002606331*^9, {3.647844384728939*^9, 3.647844402828513*^9}, 
   3.64784454811069*^9, 3.6478550732167187`*^9, 3.647855909512701*^9, {
   3.647856004021459*^9, 3.6478560178407784`*^9}, 3.647856900975731*^9, 
   3.647857098741403*^9, 3.6478571437716093`*^9, 3.647857221998946*^9, 
   3.647859825416401*^9, 3.647860361457292*^9, 3.647860436340768*^9, 
   3.6478606159191723`*^9, {3.647860675775897*^9, 3.64786071496154*^9}, 
   3.647923087140091*^9, {3.6479235146821003`*^9, 3.647923519196891*^9}, 
   3.64793562173446*^9, 3.648796215296343*^9, {3.648800674738817*^9, 
   3.6488006860586452`*^9}, 3.648801057487286*^9, 3.648801352415284*^9, 
   3.6488034526326714`*^9, {3.6489754952628508`*^9, 3.648975498524254*^9}, {
   3.648975597226184*^9, 3.648975616555307*^9}, 3.6493899148661737`*^9, 
   3.6500954725274553`*^9, 3.650096139306801*^9, 3.650096331220332*^9, 
   3.650096371372316*^9, 3.65009700428041*^9, 3.650097603295561*^9, 
   3.650097687242648*^9, {3.6500981254520807`*^9, 3.650098142130761*^9}, 
   3.65009817936075*^9, 3.650098229098768*^9, 3.650098306796404*^9, {
   3.6500983585099993`*^9, 3.65009837773004*^9}, 3.650098419315194*^9, 
   3.650098816824753*^9, 3.6500988906154537`*^9, 3.650098983485783*^9, 
   3.650099174008572*^9, 3.650099326460449*^9, 3.650099761791978*^9, 
   3.6500998332968283`*^9, 3.650100244256315*^9, 3.650101865460096*^9, 
   3.650101967035433*^9, 3.650102167430299*^9, 3.650284783220605*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "u", "]"}], "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.647599652092414*^9, 3.6475999016899223`*^9, 3.647600101883606*^9, 
   3.647602229821965*^9, 3.6476024806888857`*^9, 3.64766790397863*^9, 
   3.647669526524805*^9, 3.6476696492977047`*^9, 3.647670171816669*^9, 
   3.647673094983068*^9, {3.647673145598823*^9, 3.6476731488412733`*^9}, 
   3.647842002606331*^9, {3.647844384728939*^9, 3.647844402828513*^9}, 
   3.64784454811069*^9, 3.6478550732167187`*^9, 3.647855909512701*^9, {
   3.647856004021459*^9, 3.6478560178407784`*^9}, 3.647856900975731*^9, 
   3.647857098741403*^9, 3.6478571437716093`*^9, 3.647857221998946*^9, 
   3.647859825416401*^9, 3.647860361457292*^9, 3.647860436340768*^9, 
   3.6478606159191723`*^9, {3.647860675775897*^9, 3.64786071496154*^9}, 
   3.647923087140091*^9, {3.6479235146821003`*^9, 3.647923519196891*^9}, 
   3.64793562173446*^9, 3.648796215296343*^9, {3.648800674738817*^9, 
   3.6488006860586452`*^9}, 3.648801057487286*^9, 3.648801352415284*^9, 
   3.6488034526326714`*^9, {3.6489754952628508`*^9, 3.648975498524254*^9}, {
   3.648975597226184*^9, 3.648975616555307*^9}, 3.6493899148661737`*^9, 
   3.6500954725274553`*^9, 3.650096139306801*^9, 3.650096331220332*^9, 
   3.650096371372316*^9, 3.65009700428041*^9, 3.650097603295561*^9, 
   3.650097687242648*^9, {3.6500981254520807`*^9, 3.650098142130761*^9}, 
   3.65009817936075*^9, 3.650098229098768*^9, 3.650098306796404*^9, {
   3.6500983585099993`*^9, 3.65009837773004*^9}, 3.650098419315194*^9, 
   3.650098816824753*^9, 3.6500988906154537`*^9, 3.650098983485783*^9, 
   3.650099174008572*^9, 3.650099326460449*^9, 3.650099761791978*^9, 
   3.6500998332968283`*^9, 3.650100244256315*^9, 3.650101865460096*^9, 
   3.650101967035433*^9, 3.650102167430299*^9, 3.6502847832256327`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SuperscriptBox[
      RowBox[{"Csc", "[", "u", "]"}], "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.647599652092414*^9, 3.6475999016899223`*^9, 3.647600101883606*^9, 
   3.647602229821965*^9, 3.6476024806888857`*^9, 3.64766790397863*^9, 
   3.647669526524805*^9, 3.6476696492977047`*^9, 3.647670171816669*^9, 
   3.647673094983068*^9, {3.647673145598823*^9, 3.6476731488412733`*^9}, 
   3.647842002606331*^9, {3.647844384728939*^9, 3.647844402828513*^9}, 
   3.64784454811069*^9, 3.6478550732167187`*^9, 3.647855909512701*^9, {
   3.647856004021459*^9, 3.6478560178407784`*^9}, 3.647856900975731*^9, 
   3.647857098741403*^9, 3.6478571437716093`*^9, 3.647857221998946*^9, 
   3.647859825416401*^9, 3.647860361457292*^9, 3.647860436340768*^9, 
   3.6478606159191723`*^9, {3.647860675775897*^9, 3.64786071496154*^9}, 
   3.647923087140091*^9, {3.6479235146821003`*^9, 3.647923519196891*^9}, 
   3.64793562173446*^9, 3.648796215296343*^9, {3.648800674738817*^9, 
   3.6488006860586452`*^9}, 3.648801057487286*^9, 3.648801352415284*^9, 
   3.6488034526326714`*^9, {3.6489754952628508`*^9, 3.648975498524254*^9}, {
   3.648975597226184*^9, 3.648975616555307*^9}, 3.6493899148661737`*^9, 
   3.6500954725274553`*^9, 3.650096139306801*^9, 3.650096331220332*^9, 
   3.650096371372316*^9, 3.65009700428041*^9, 3.650097603295561*^9, 
   3.650097687242648*^9, {3.6500981254520807`*^9, 3.650098142130761*^9}, 
   3.65009817936075*^9, 3.650098229098768*^9, 3.650098306796404*^9, {
   3.6500983585099993`*^9, 3.65009837773004*^9}, 3.650098419315194*^9, 
   3.650098816824753*^9, 3.6500988906154537`*^9, 3.650098983485783*^9, 
   3.650099174008572*^9, 3.650099326460449*^9, 3.650099761791978*^9, 
   3.6500998332968283`*^9, 3.650100244256315*^9, 3.650101865460096*^9, 
   3.650101967035433*^9, 3.650102167430299*^9, 3.650284783226201*^9}],

Cell[BoxData[
 RowBox[{"Sin", "[", "u", "]"}]], "Output",
 CellChangeTimes->{
  3.647599652092414*^9, 3.6475999016899223`*^9, 3.647600101883606*^9, 
   3.647602229821965*^9, 3.6476024806888857`*^9, 3.64766790397863*^9, 
   3.647669526524805*^9, 3.6476696492977047`*^9, 3.647670171816669*^9, 
   3.647673094983068*^9, {3.647673145598823*^9, 3.6476731488412733`*^9}, 
   3.647842002606331*^9, {3.647844384728939*^9, 3.647844402828513*^9}, 
   3.64784454811069*^9, 3.6478550732167187`*^9, 3.647855909512701*^9, {
   3.647856004021459*^9, 3.6478560178407784`*^9}, 3.647856900975731*^9, 
   3.647857098741403*^9, 3.6478571437716093`*^9, 3.647857221998946*^9, 
   3.647859825416401*^9, 3.647860361457292*^9, 3.647860436340768*^9, 
   3.6478606159191723`*^9, {3.647860675775897*^9, 3.64786071496154*^9}, 
   3.647923087140091*^9, {3.6479235146821003`*^9, 3.647923519196891*^9}, 
   3.64793562173446*^9, 3.648796215296343*^9, {3.648800674738817*^9, 
   3.6488006860586452`*^9}, 3.648801057487286*^9, 3.648801352415284*^9, 
   3.6488034526326714`*^9, {3.6489754952628508`*^9, 3.648975498524254*^9}, {
   3.648975597226184*^9, 3.648975616555307*^9}, 3.6493899148661737`*^9, 
   3.6500954725274553`*^9, 3.650096139306801*^9, 3.650096331220332*^9, 
   3.650096371372316*^9, 3.65009700428041*^9, 3.650097603295561*^9, 
   3.650097687242648*^9, {3.6500981254520807`*^9, 3.650098142130761*^9}, 
   3.65009817936075*^9, 3.650098229098768*^9, 3.650098306796404*^9, {
   3.6500983585099993`*^9, 3.65009837773004*^9}, 3.650098419315194*^9, 
   3.650098816824753*^9, 3.6500988906154537`*^9, 3.650098983485783*^9, 
   3.650099174008572*^9, 3.650099326460449*^9, 3.650099761791978*^9, 
   3.6500998332968283`*^9, 3.650100244256315*^9, 3.650101865460096*^9, 
   3.650101967035433*^9, 3.650102167430299*^9, 3.6502847832267323`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Xu", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"X", ",", "u"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"Xv", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"X", ",", "v"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nuDirection", "=", 
   RowBox[{
    RowBox[{"Cross", "[", 
     RowBox[{"Xu", ",", "Xv"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nu", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"nuDirection", ".", "nuDirection"}], "]"}]}], ")"}], "*", 
     "nuDirection"}], "//", "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.647599691242261*^9, 3.647599751408003*^9}, {
  3.647856329766807*^9, 3.647856351306697*^9}, {3.650006191122903*^9, 
  3.650006201011973*^9}, {3.6500970364149303`*^9, 3.6500970377421217`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "u", "]"}], " ", 
    RowBox[{"Cos", "[", "v", "]"}]}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", "u", "]"}], " ", 
    RowBox[{"Sin", "[", "v", "]"}]}], ",", 
   RowBox[{"-", 
    RowBox[{"Sin", "[", "u", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.650097038570037*^9, 3.650097603309362*^9, 3.650097687263299*^9, {
   3.6500981254714518`*^9, 3.650098142163086*^9}, 3.6500981793836803`*^9, 
   3.650098229119266*^9, 3.6500983068404207`*^9, {3.65009835855336*^9, 
   3.6500983777743692`*^9}, 3.650098419362083*^9, 3.650098816869985*^9, 
   3.650098890661873*^9, 3.650098983509533*^9, 3.650099174034099*^9, 
   3.650099326486278*^9, 3.6500997618226852`*^9, 3.650099833316814*^9, 
   3.650100244278707*^9, 3.650101865487008*^9, 3.650101967061249*^9, 
   3.6501021674491568`*^9, 3.65028478323987*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Sin", "[", "u", "]"}]}], " ", 
    RowBox[{"Sin", "[", "v", "]"}]}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", "v", "]"}], " ", 
    RowBox[{"Sin", "[", "u", "]"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.650097038570037*^9, 3.650097603309362*^9, 3.650097687263299*^9, {
   3.6500981254714518`*^9, 3.650098142163086*^9}, 3.6500981793836803`*^9, 
   3.650098229119266*^9, 3.6500983068404207`*^9, {3.65009835855336*^9, 
   3.6500983777743692`*^9}, 3.650098419362083*^9, 3.650098816869985*^9, 
   3.650098890661873*^9, 3.650098983509533*^9, 3.650099174034099*^9, 
   3.650099326486278*^9, 3.6500997618226852`*^9, 3.650099833316814*^9, 
   3.650100244278707*^9, 3.650101865487008*^9, 3.650101967061249*^9, 
   3.6501021674491568`*^9, 3.650284783245308*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"HVec", "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"LBeltrami0", "[", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "u", ",", "v", ",", "g"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{"HVec", ".", "nu"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"H", "/.", 
  RowBox[{"t", "\[Rule]", "0"}]}]}], "Input",
 CellChangeTimes->{{3.64784493907845*^9, 3.647844949830113*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.647599796273897*^9, 3.647599902712368*^9, 3.647600102861208*^9, 
   3.647602230740696*^9, 3.6476024807894087`*^9, 3.64766790496751*^9, 
   3.647669526670609*^9, 3.647669649809052*^9, 3.647670171935514*^9, 
   3.647673095935443*^9, 3.647673149305298*^9, 3.647842003122168*^9, {
   3.647844387382812*^9, 3.647844403268015*^9}, 3.6478445486220293`*^9, 
   3.64784495111333*^9, 3.6478550733195963`*^9, 3.647855909618404*^9, 
   3.647856019776608*^9, 3.647856901050366*^9, 3.647857101270516*^9, 
   3.647857143893333*^9, 3.6478572221361637`*^9, 3.647859825511465*^9, 
   3.647860362005596*^9, 3.6478604363735933`*^9, 3.647860615949443*^9, {
   3.64786067578723*^9, 3.6478607149748917`*^9}, 3.647923087659729*^9, 
   3.647935622935483*^9, 3.648796215833233*^9, {3.648800674829262*^9, 
   3.648800686126768*^9}, 3.648801058614592*^9, 3.648801353603839*^9, 
   3.6488034538836813`*^9, 3.64897549869775*^9, {3.6489755974158173`*^9, 
   3.648975616585452*^9}, 3.6493899154850616`*^9, 3.6500954726953163`*^9, 
   3.6500961393290977`*^9, 3.650096331647209*^9, 3.650096371436104*^9, 
   3.650097004316504*^9, 3.650097603340518*^9, 3.650097687294191*^9, {
   3.650098125505755*^9, 3.650098142195457*^9}, 3.6500981794174128`*^9, 
   3.650098229148374*^9, 3.650098306867507*^9, {3.650098358580566*^9, 
   3.6500983778000937`*^9}, 3.650098419389845*^9, 3.650098816898785*^9, 
   3.650098890688363*^9, 3.650098983540449*^9, 3.650099174060007*^9, 
   3.6500993265157347`*^9, 3.6500997618709393`*^9, 3.650099833359091*^9, 
   3.650100244312044*^9, 3.6501018655206633`*^9, 3.650101967097986*^9, 
   3.650102167482583*^9, 3.650284783272862*^9}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.647599796273897*^9, 3.647599902712368*^9, 3.647600102861208*^9, 
   3.647602230740696*^9, 3.6476024807894087`*^9, 3.64766790496751*^9, 
   3.647669526670609*^9, 3.647669649809052*^9, 3.647670171935514*^9, 
   3.647673095935443*^9, 3.647673149305298*^9, 3.647842003122168*^9, {
   3.647844387382812*^9, 3.647844403268015*^9}, 3.6478445486220293`*^9, 
   3.64784495111333*^9, 3.6478550733195963`*^9, 3.647855909618404*^9, 
   3.647856019776608*^9, 3.647856901050366*^9, 3.647857101270516*^9, 
   3.647857143893333*^9, 3.6478572221361637`*^9, 3.647859825511465*^9, 
   3.647860362005596*^9, 3.6478604363735933`*^9, 3.647860615949443*^9, {
   3.64786067578723*^9, 3.6478607149748917`*^9}, 3.647923087659729*^9, 
   3.647935622935483*^9, 3.648796215833233*^9, {3.648800674829262*^9, 
   3.648800686126768*^9}, 3.648801058614592*^9, 3.648801353603839*^9, 
   3.6488034538836813`*^9, 3.64897549869775*^9, {3.6489755974158173`*^9, 
   3.648975616585452*^9}, 3.6493899154850616`*^9, 3.6500954726953163`*^9, 
   3.6500961393290977`*^9, 3.650096331647209*^9, 3.650096371436104*^9, 
   3.650097004316504*^9, 3.650097603340518*^9, 3.650097687294191*^9, {
   3.650098125505755*^9, 3.650098142195457*^9}, 3.6500981794174128`*^9, 
   3.650098229148374*^9, 3.650098306867507*^9, {3.650098358580566*^9, 
   3.6500983778000937`*^9}, 3.650098419389845*^9, 3.650098816898785*^9, 
   3.650098890688363*^9, 3.650098983540449*^9, 3.650099174060007*^9, 
   3.6500993265157347`*^9, 3.6500997618709393`*^9, 3.650099833359091*^9, 
   3.650100244312044*^9, 3.6501018655206633`*^9, 3.650101967097986*^9, 
   3.650102167482583*^9, 3.650284783273435*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xuu", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"Xu", ",", "u"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xuv", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"Xu", ",", "v"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xvv", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"Xv", ",", "v"}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"II", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nu", ".", "Xuu"}], ",", 
       RowBox[{"nu", ".", "Xuv"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nu", ".", "Xuv"}], ",", 
       RowBox[{"nu", ".", "Xvv"}]}], "}"}]}], "}"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"S", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Inverse", "[", "g", "]"}], ".", "II"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tr", "[", "S", "]"}], "+", "H"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"K", "=", 
  RowBox[{
   RowBox[{"Det", "[", "S", "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"K", "/.", 
  RowBox[{"t", "\[Rule]", "0"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQrb7wXney7mvHphNfekH0h+n170F01m77TyA6Pfjn
dxA9/fHenyB6R+W9xFQgvUWxugREC8hvqAfRLzLXN4DoN3tWzALRlldi54No
Q45pi8Hyf1YvB9Fcq+PWgGifJW4bQfT6nD0nQHTpxNtg+sSDc+fA6jg+XgHR
Ii7zboPoNEanhyB6w+WG5yD6yP0vr0H0rFYphzQgrXUyEkz3XN3zZCuQbqzS
fw6i9RYe/A+ib3y+DaZfnXVQ2Qby34NdmiCabbWbM4i+pD7HDUSHpU7zA9F2
8/76g2ijSRm9IPrYmb19IPokE2v0diC9qWkvmJ6WzZ0Notf5RBSAaAHOyhoQ
bbY7vxVEn7Rm6HsE8k/qBTD9j1m8u13/tWMz594+EA0AskzEcQ==
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "u", "]"}], "2"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.647676360246623*^9, 3.647676366696045*^9}, 
   3.647679362868113*^9, 3.64767949666289*^9, 3.647679739628948*^9, {
   3.647679776355625*^9, 3.6476798058272333`*^9}, {3.647679854237474*^9, 
   3.647679882741634*^9}, {3.64768012429795*^9, 3.647680167873261*^9}, 
   3.647680222769987*^9, 3.6476802664749527`*^9, {3.647680322770823*^9, 
   3.64768035211064*^9}, 3.647681029689801*^9, 3.647842003351919*^9, {
   3.6478441485011473`*^9, 3.6478441539799757`*^9}, 3.6478443515197887`*^9, {
   3.647844387435235*^9, 3.647844403511991*^9}, 3.6478445488814497`*^9, {
   3.6478446655552797`*^9, 3.6478446866716413`*^9}, 3.647844917377612*^9, 
   3.647844992635455*^9, 3.647845494850936*^9, 3.6478471342937527`*^9, {
   3.6478472609943438`*^9, 3.647847299441513*^9}, {3.647847406819435*^9, 
   3.647847441423793*^9}, 3.6478550733621283`*^9, 3.6478559096670647`*^9, 
   3.647856020113296*^9, 3.6478569010991783`*^9, 3.647857111177188*^9, 
   3.6478571439269247`*^9, 3.647857222209448*^9, 3.647859825557592*^9, 
   3.647860362275358*^9, 3.647860436434826*^9, 3.647860616008622*^9, {
   3.647860675806364*^9, 3.647860714999227*^9}, 3.647923087930737*^9, 
   3.6479356266105328`*^9, 3.648796216109318*^9, 3.648797816831089*^9, {
   3.648800674887537*^9, 3.648800686186142*^9}, 3.648801062231782*^9, 
   3.6488013572552137`*^9, 3.648803457437872*^9, 3.648975498801887*^9, {
   3.648975598617633*^9, 3.648975616628674*^9}, 3.649389916082137*^9, 
   3.650095472716012*^9, 3.650096139359923*^9, 3.650096331745438*^9, 
   3.650096371466674*^9, 3.650097004342359*^9, 3.650097603374216*^9, 
   3.650097687320879*^9, {3.6500981255331583`*^9, 3.6500981422319183`*^9}, 
   3.650098179452671*^9, 3.650098229176372*^9, 3.650098306892643*^9, {
   3.650098358604225*^9, 3.6500983778235197`*^9}, 3.650098419420273*^9, 
   3.650098816922683*^9, 3.650098890724225*^9, 3.65009898358075*^9, 
   3.650099174089027*^9, 3.650099326538416*^9, 3.6500997619028254`*^9, 
   3.650099833383704*^9, 3.650100244346451*^9, 3.650101865557086*^9, 
   3.650101967130885*^9, 3.650102167511373*^9, 3.650284783296606*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.647676360246623*^9, 3.647676366696045*^9}, 
   3.647679362868113*^9, 3.64767949666289*^9, 3.647679739628948*^9, {
   3.647679776355625*^9, 3.6476798058272333`*^9}, {3.647679854237474*^9, 
   3.647679882741634*^9}, {3.64768012429795*^9, 3.647680167873261*^9}, 
   3.647680222769987*^9, 3.6476802664749527`*^9, {3.647680322770823*^9, 
   3.64768035211064*^9}, 3.647681029689801*^9, 3.647842003351919*^9, {
   3.6478441485011473`*^9, 3.6478441539799757`*^9}, 3.6478443515197887`*^9, {
   3.647844387435235*^9, 3.647844403511991*^9}, 3.6478445488814497`*^9, {
   3.6478446655552797`*^9, 3.6478446866716413`*^9}, 3.647844917377612*^9, 
   3.647844992635455*^9, 3.647845494850936*^9, 3.6478471342937527`*^9, {
   3.6478472609943438`*^9, 3.647847299441513*^9}, {3.647847406819435*^9, 
   3.647847441423793*^9}, 3.6478550733621283`*^9, 3.6478559096670647`*^9, 
   3.647856020113296*^9, 3.6478569010991783`*^9, 3.647857111177188*^9, 
   3.6478571439269247`*^9, 3.647857222209448*^9, 3.647859825557592*^9, 
   3.647860362275358*^9, 3.647860436434826*^9, 3.647860616008622*^9, {
   3.647860675806364*^9, 3.647860714999227*^9}, 3.647923087930737*^9, 
   3.6479356266105328`*^9, 3.648796216109318*^9, 3.648797816831089*^9, {
   3.648800674887537*^9, 3.648800686186142*^9}, 3.648801062231782*^9, 
   3.6488013572552137`*^9, 3.648803457437872*^9, 3.648975498801887*^9, {
   3.648975598617633*^9, 3.648975616628674*^9}, 3.649389916082137*^9, 
   3.650095472716012*^9, 3.650096139359923*^9, 3.650096331745438*^9, 
   3.650096371466674*^9, 3.650097004342359*^9, 3.650097603374216*^9, 
   3.650097687320879*^9, {3.6500981255331583`*^9, 3.6500981422319183`*^9}, 
   3.650098179452671*^9, 3.650098229176372*^9, 3.650098306892643*^9, {
   3.650098358604225*^9, 3.6500983778235197`*^9}, 3.650098419420273*^9, 
   3.650098816922683*^9, 3.650098890724225*^9, 3.65009898358075*^9, 
   3.650099174089027*^9, 3.650099326538416*^9, 3.6500997619028254`*^9, 
   3.650099833383704*^9, 3.650100244346451*^9, 3.650101865557086*^9, 
   3.650101967130885*^9, 3.650102167511373*^9, 3.6502847832972193`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.647676360246623*^9, 3.647676366696045*^9}, 
   3.647679362868113*^9, 3.64767949666289*^9, 3.647679739628948*^9, {
   3.647679776355625*^9, 3.6476798058272333`*^9}, {3.647679854237474*^9, 
   3.647679882741634*^9}, {3.64768012429795*^9, 3.647680167873261*^9}, 
   3.647680222769987*^9, 3.6476802664749527`*^9, {3.647680322770823*^9, 
   3.64768035211064*^9}, 3.647681029689801*^9, 3.647842003351919*^9, {
   3.6478441485011473`*^9, 3.6478441539799757`*^9}, 3.6478443515197887`*^9, {
   3.647844387435235*^9, 3.647844403511991*^9}, 3.6478445488814497`*^9, {
   3.6478446655552797`*^9, 3.6478446866716413`*^9}, 3.647844917377612*^9, 
   3.647844992635455*^9, 3.647845494850936*^9, 3.6478471342937527`*^9, {
   3.6478472609943438`*^9, 3.647847299441513*^9}, {3.647847406819435*^9, 
   3.647847441423793*^9}, 3.6478550733621283`*^9, 3.6478559096670647`*^9, 
   3.647856020113296*^9, 3.6478569010991783`*^9, 3.647857111177188*^9, 
   3.6478571439269247`*^9, 3.647857222209448*^9, 3.647859825557592*^9, 
   3.647860362275358*^9, 3.647860436434826*^9, 3.647860616008622*^9, {
   3.647860675806364*^9, 3.647860714999227*^9}, 3.647923087930737*^9, 
   3.6479356266105328`*^9, 3.648796216109318*^9, 3.648797816831089*^9, {
   3.648800674887537*^9, 3.648800686186142*^9}, 3.648801062231782*^9, 
   3.6488013572552137`*^9, 3.648803457437872*^9, 3.648975498801887*^9, {
   3.648975598617633*^9, 3.648975616628674*^9}, 3.649389916082137*^9, 
   3.650095472716012*^9, 3.650096139359923*^9, 3.650096331745438*^9, 
   3.650096371466674*^9, 3.650097004342359*^9, 3.650097603374216*^9, 
   3.650097687320879*^9, {3.6500981255331583`*^9, 3.6500981422319183`*^9}, 
   3.650098179452671*^9, 3.650098229176372*^9, 3.650098306892643*^9, {
   3.650098358604225*^9, 3.6500983778235197`*^9}, 3.650098419420273*^9, 
   3.650098816922683*^9, 3.650098890724225*^9, 3.65009898358075*^9, 
   3.650099174089027*^9, 3.650099326538416*^9, 3.6500997619028254`*^9, 
   3.650099833383704*^9, 3.650100244346451*^9, 3.650101865557086*^9, 
   3.650101967130885*^9, 3.650102167511373*^9, 3.650284783297714*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.647676360246623*^9, 3.647676366696045*^9}, 
   3.647679362868113*^9, 3.64767949666289*^9, 3.647679739628948*^9, {
   3.647679776355625*^9, 3.6476798058272333`*^9}, {3.647679854237474*^9, 
   3.647679882741634*^9}, {3.64768012429795*^9, 3.647680167873261*^9}, 
   3.647680222769987*^9, 3.6476802664749527`*^9, {3.647680322770823*^9, 
   3.64768035211064*^9}, 3.647681029689801*^9, 3.647842003351919*^9, {
   3.6478441485011473`*^9, 3.6478441539799757`*^9}, 3.6478443515197887`*^9, {
   3.647844387435235*^9, 3.647844403511991*^9}, 3.6478445488814497`*^9, {
   3.6478446655552797`*^9, 3.6478446866716413`*^9}, 3.647844917377612*^9, 
   3.647844992635455*^9, 3.647845494850936*^9, 3.6478471342937527`*^9, {
   3.6478472609943438`*^9, 3.647847299441513*^9}, {3.647847406819435*^9, 
   3.647847441423793*^9}, 3.6478550733621283`*^9, 3.6478559096670647`*^9, 
   3.647856020113296*^9, 3.6478569010991783`*^9, 3.647857111177188*^9, 
   3.6478571439269247`*^9, 3.647857222209448*^9, 3.647859825557592*^9, 
   3.647860362275358*^9, 3.647860436434826*^9, 3.647860616008622*^9, {
   3.647860675806364*^9, 3.647860714999227*^9}, 3.647923087930737*^9, 
   3.6479356266105328`*^9, 3.648796216109318*^9, 3.648797816831089*^9, {
   3.648800674887537*^9, 3.648800686186142*^9}, 3.648801062231782*^9, 
   3.6488013572552137`*^9, 3.648803457437872*^9, 3.648975498801887*^9, {
   3.648975598617633*^9, 3.648975616628674*^9}, 3.649389916082137*^9, 
   3.650095472716012*^9, 3.650096139359923*^9, 3.650096331745438*^9, 
   3.650096371466674*^9, 3.650097004342359*^9, 3.650097603374216*^9, 
   3.650097687320879*^9, {3.6500981255331583`*^9, 3.6500981422319183`*^9}, 
   3.650098179452671*^9, 3.650098229176372*^9, 3.650098306892643*^9, {
   3.650098358604225*^9, 3.6500983778235197`*^9}, 3.650098419420273*^9, 
   3.650098816922683*^9, 3.650098890724225*^9, 3.65009898358075*^9, 
   3.650099174089027*^9, 3.650099326538416*^9, 3.6500997619028254`*^9, 
   3.650099833383704*^9, 3.650100244346451*^9, 3.650101865557086*^9, 
   3.650101967130885*^9, 3.650102167511373*^9, 3.650284783298201*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.647676360246623*^9, 3.647676366696045*^9}, 
   3.647679362868113*^9, 3.64767949666289*^9, 3.647679739628948*^9, {
   3.647679776355625*^9, 3.6476798058272333`*^9}, {3.647679854237474*^9, 
   3.647679882741634*^9}, {3.64768012429795*^9, 3.647680167873261*^9}, 
   3.647680222769987*^9, 3.6476802664749527`*^9, {3.647680322770823*^9, 
   3.64768035211064*^9}, 3.647681029689801*^9, 3.647842003351919*^9, {
   3.6478441485011473`*^9, 3.6478441539799757`*^9}, 3.6478443515197887`*^9, {
   3.647844387435235*^9, 3.647844403511991*^9}, 3.6478445488814497`*^9, {
   3.6478446655552797`*^9, 3.6478446866716413`*^9}, 3.647844917377612*^9, 
   3.647844992635455*^9, 3.647845494850936*^9, 3.6478471342937527`*^9, {
   3.6478472609943438`*^9, 3.647847299441513*^9}, {3.647847406819435*^9, 
   3.647847441423793*^9}, 3.6478550733621283`*^9, 3.6478559096670647`*^9, 
   3.647856020113296*^9, 3.6478569010991783`*^9, 3.647857111177188*^9, 
   3.6478571439269247`*^9, 3.647857222209448*^9, 3.647859825557592*^9, 
   3.647860362275358*^9, 3.647860436434826*^9, 3.647860616008622*^9, {
   3.647860675806364*^9, 3.647860714999227*^9}, 3.647923087930737*^9, 
   3.6479356266105328`*^9, 3.648796216109318*^9, 3.648797816831089*^9, {
   3.648800674887537*^9, 3.648800686186142*^9}, 3.648801062231782*^9, 
   3.6488013572552137`*^9, 3.648803457437872*^9, 3.648975498801887*^9, {
   3.648975598617633*^9, 3.648975616628674*^9}, 3.649389916082137*^9, 
   3.650095472716012*^9, 3.650096139359923*^9, 3.650096331745438*^9, 
   3.650096371466674*^9, 3.650097004342359*^9, 3.650097603374216*^9, 
   3.650097687320879*^9, {3.6500981255331583`*^9, 3.6500981422319183`*^9}, 
   3.650098179452671*^9, 3.650098229176372*^9, 3.650098306892643*^9, {
   3.650098358604225*^9, 3.6500983778235197`*^9}, 3.650098419420273*^9, 
   3.650098816922683*^9, 3.650098890724225*^9, 3.65009898358075*^9, 
   3.650099174089027*^9, 3.650099326538416*^9, 3.6500997619028254`*^9, 
   3.650099833383704*^9, 3.650100244346451*^9, 3.650101865557086*^9, 
   3.650101967130885*^9, 3.650102167511373*^9, 3.650284783298686*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"alpha", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a1", "[", 
     RowBox[{"u", ",", "v"}], "]"}], ",", 
    RowBox[{"a2", "[", 
     RowBox[{"u", ",", "v"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"p", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "[", 
     RowBox[{"u", ",", "v"}], "]"}], ",", 
    RowBox[{"p2", "[", 
     RowBox[{"u", ",", "v"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"p", "=", 
  RowBox[{"{", 
   RowBox[{"1", ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", ".", "g", ".", "p"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"flp", "=", 
  RowBox[{
   RowBox[{"Flat1", "[", 
    RowBox[{"p", ",", "g"}], "]"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.648975640891055*^9, 3.648975655554612*^9}, {
  3.649389927437911*^9, 3.649389952421946*^9}, {3.650095627590562*^9, 
  3.650095635593996*^9}, {3.650096681023712*^9, 3.650096692655645*^9}, {
  3.65009698744004*^9, 3.650096993710881*^9}, {3.6500977186572523`*^9, 
  3.6500977274841423`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a1", "[", 
    RowBox[{"u", ",", "v"}], "]"}], ",", 
   RowBox[{"a2", "[", 
    RowBox[{"u", ",", "v"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.648975656447102*^9, 3.649389916186878*^9, 3.649389952958989*^9, 
   3.650095472733519*^9, 3.650095636212697*^9, 3.650096139381605*^9, 
   3.6500963319761066`*^9, 3.650096371497738*^9, 3.6500966930572033`*^9, 
   3.650097004366846*^9, 3.650097603395609*^9, 3.650097687342972*^9, 
   3.650097727968204*^9, {3.6500981255543833`*^9, 3.650098142260048*^9}, 
   3.650098179478067*^9, 3.650098229201511*^9, 3.6500983069158363`*^9, {
   3.650098358628524*^9, 3.65009837784702*^9}, 3.650098419438039*^9, 
   3.650098816946018*^9, 3.650098890752665*^9, 3.650098983601934*^9, 
   3.650099174110939*^9, 3.650099326556807*^9, 3.6500997619245777`*^9, 
   3.650099833406621*^9, 3.6501002443819447`*^9, 3.650101865581318*^9, 
   3.650101967151924*^9, 3.650102167531931*^9, 3.650284783317259*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"p1", "[", 
    RowBox[{"u", ",", "v"}], "]"}], ",", 
   RowBox[{"p2", "[", 
    RowBox[{"u", ",", "v"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.648975656447102*^9, 3.649389916186878*^9, 3.649389952958989*^9, 
   3.650095472733519*^9, 3.650095636212697*^9, 3.650096139381605*^9, 
   3.6500963319761066`*^9, 3.650096371497738*^9, 3.6500966930572033`*^9, 
   3.650097004366846*^9, 3.650097603395609*^9, 3.650097687342972*^9, 
   3.650097727968204*^9, {3.6500981255543833`*^9, 3.650098142260048*^9}, 
   3.650098179478067*^9, 3.650098229201511*^9, 3.6500983069158363`*^9, {
   3.650098358628524*^9, 3.65009837784702*^9}, 3.650098419438039*^9, 
   3.650098816946018*^9, 3.650098890752665*^9, 3.650098983601934*^9, 
   3.650099174110939*^9, 3.650099326556807*^9, 3.6500997619245777`*^9, 
   3.650099833406621*^9, 3.6501002443819447`*^9, 3.650101865581318*^9, 
   3.650101967151924*^9, 3.650102167531931*^9, 3.6502847833178368`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.648975656447102*^9, 3.649389916186878*^9, 3.649389952958989*^9, 
   3.650095472733519*^9, 3.650095636212697*^9, 3.650096139381605*^9, 
   3.6500963319761066`*^9, 3.650096371497738*^9, 3.6500966930572033`*^9, 
   3.650097004366846*^9, 3.650097603395609*^9, 3.650097687342972*^9, 
   3.650097727968204*^9, {3.6500981255543833`*^9, 3.650098142260048*^9}, 
   3.650098179478067*^9, 3.650098229201511*^9, 3.6500983069158363`*^9, {
   3.650098358628524*^9, 3.65009837784702*^9}, 3.650098419438039*^9, 
   3.650098816946018*^9, 3.650098890752665*^9, 3.650098983601934*^9, 
   3.650099174110939*^9, 3.650099326556807*^9, 3.6500997619245777`*^9, 
   3.650099833406621*^9, 3.6501002443819447`*^9, 3.650101865581318*^9, 
   3.650101967151924*^9, 3.650102167531931*^9, 3.650284783318336*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.648975656447102*^9, 3.649389916186878*^9, 3.649389952958989*^9, 
   3.650095472733519*^9, 3.650095636212697*^9, 3.650096139381605*^9, 
   3.6500963319761066`*^9, 3.650096371497738*^9, 3.6500966930572033`*^9, 
   3.650097004366846*^9, 3.650097603395609*^9, 3.650097687342972*^9, 
   3.650097727968204*^9, {3.6500981255543833`*^9, 3.650098142260048*^9}, 
   3.650098179478067*^9, 3.650098229201511*^9, 3.6500983069158363`*^9, {
   3.650098358628524*^9, 3.65009837784702*^9}, 3.650098419438039*^9, 
   3.650098816946018*^9, 3.650098890752665*^9, 3.650098983601934*^9, 
   3.650099174110939*^9, 3.650099326556807*^9, 3.6500997619245777`*^9, 
   3.650099833406621*^9, 3.6501002443819447`*^9, 3.650101865581318*^9, 
   3.650101967151924*^9, 3.650102167531931*^9, 3.650284783336719*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.648975656447102*^9, 3.649389916186878*^9, 3.649389952958989*^9, 
   3.650095472733519*^9, 3.650095636212697*^9, 3.650096139381605*^9, 
   3.6500963319761066`*^9, 3.650096371497738*^9, 3.6500966930572033`*^9, 
   3.650097004366846*^9, 3.650097603395609*^9, 3.650097687342972*^9, 
   3.650097727968204*^9, {3.6500981255543833`*^9, 3.650098142260048*^9}, 
   3.650098179478067*^9, 3.650098229201511*^9, 3.6500983069158363`*^9, {
   3.650098358628524*^9, 3.65009837784702*^9}, 3.650098419438039*^9, 
   3.650098816946018*^9, 3.650098890752665*^9, 3.650098983601934*^9, 
   3.650099174110939*^9, 3.650099326556807*^9, 3.6500997619245777`*^9, 
   3.650099833406621*^9, 3.6501002443819447`*^9, 3.650101865581318*^9, 
   3.650101967151924*^9, 3.650102167531931*^9, 3.650284783342661*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Phi]", "=", 
  RowBox[{"u", "/", "2"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"\[Phi]", "=", 
    RowBox[{"f", "[", 
     RowBox[{"u", ",", "v"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"\[Phi]", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", "u", "]"}], "+", "1"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"\[Pi]", "/", "4"}], ")"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"q", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "\[Phi]", "]"}], "*", "p"}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
     RowBox[{"Sharp1", "[", 
      RowBox[{
       RowBox[{"Hodge1", "[", 
        RowBox[{
         RowBox[{"Flat1", "[", 
          RowBox[{"p", ",", "g"}], "]"}], ",", "g"}], "]"}], ",", "g"}], 
      "]"}]}]}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"flq", "=", 
  RowBox[{
   RowBox[{"Flat1", "[", 
    RowBox[{"q", ",", "g"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q", ".", "g", ".", "q"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.650095494507143*^9, 3.650095524057866*^9}, {
   3.650095557676227*^9, 3.65009561305241*^9}, {3.6500957717262573`*^9, 
   3.65009579018331*^9}, {3.650095963855562*^9, 3.650095981938322*^9}, {
   3.650096628882359*^9, 3.650096640865954*^9}, {3.650096675585432*^9, 
   3.650096729283753*^9}, {3.650097448459721*^9, 3.650097460949999*^9}, {
   3.6500975410844593`*^9, 3.650097591430196*^9}, {3.650097683380918*^9, 
   3.650097683661162*^9}, {3.6500980501883497`*^9, 3.6500980521606197`*^9}, {
   3.6500981224743853`*^9, 3.650098132074708*^9}, {3.6500981711949997`*^9, 
   3.65009817455413*^9}, {3.650098226068982*^9, 3.6500982262266703`*^9}, {
   3.6500983041148863`*^9, 3.650098304226087*^9}, {3.650098354867195*^9, 
   3.6500983750870953`*^9}, {3.650098415635263*^9, 3.6500984165853577`*^9}, {
   3.650098805035234*^9, 3.650098805254076*^9}, {3.6500988768503304`*^9, 
   3.6500988870182943`*^9}, {3.6500989632901497`*^9, 3.650098979838977*^9}, {
   3.6500991638169737`*^9, 3.650099171131998*^9}, {3.650099314183408*^9, 
   3.6500993187459183`*^9}, {3.650099743439399*^9, 3.650099758108397*^9}, 
   3.650099829569107*^9, {3.650100139314823*^9, 3.650100148023419*^9}, {
   3.650100240595914*^9, 3.650100240738536*^9}, {3.6501017873126383`*^9, 
   3.650101839998459*^9}, {3.650101959807716*^9, 3.650101960253457*^9}, 
   3.650102164176599*^9, {3.6502847707947903`*^9, 3.6502847801711817`*^9}}],

Cell[BoxData[
 FractionBox["u", "2"]], "Output",
 CellChangeTimes->{
  3.6500956136642103`*^9, 3.650095666421328*^9, 3.650095790626585*^9, 
   3.650095982865837*^9, 3.650096139384556*^9, 3.650096332100031*^9, 
   3.6500963715362473`*^9, 3.6500967297868567`*^9, 3.650097004393835*^9, 
   3.650097463892436*^9, 3.650097603399654*^9, 3.650097687350492*^9, 
   3.650098059067706*^9, {3.6500981255586452`*^9, 3.6500981422928047`*^9}, 
   3.650098179482504*^9, 3.650098229208501*^9, 3.650098306920218*^9, {
   3.650098358637048*^9, 3.650098377851297*^9}, 3.650098419442404*^9, 
   3.65009881695048*^9, 3.65009889075694*^9, 3.6500989836073923`*^9, 
   3.650099174116123*^9, 3.650099326564844*^9, 3.650099761933268*^9, 
   3.6500998334110527`*^9, 3.650100148716216*^9, 3.650100244389867*^9, 
   3.650101865586199*^9, 3.650101967157099*^9, 3.650102167536441*^9, 
   3.6502847833655863`*^9}],

Cell[BoxData[
 FractionBox["\[Pi]", "4"]], "Output",
 CellChangeTimes->{
  3.6500956136642103`*^9, 3.650095666421328*^9, 3.650095790626585*^9, 
   3.650095982865837*^9, 3.650096139384556*^9, 3.650096332100031*^9, 
   3.6500963715362473`*^9, 3.6500967297868567`*^9, 3.650097004393835*^9, 
   3.650097463892436*^9, 3.650097603399654*^9, 3.650097687350492*^9, 
   3.650098059067706*^9, {3.6500981255586452`*^9, 3.6500981422928047`*^9}, 
   3.650098179482504*^9, 3.650098229208501*^9, 3.650098306920218*^9, {
   3.650098358637048*^9, 3.650098377851297*^9}, 3.650098419442404*^9, 
   3.65009881695048*^9, 3.65009889075694*^9, 3.6500989836073923`*^9, 
   3.650099174116123*^9, 3.650099326564844*^9, 3.650099761933268*^9, 
   3.6500998334110527`*^9, 3.650100148716216*^9, 3.650100244389867*^9, 
   3.650101865586199*^9, 3.650101967157099*^9, 3.650102167536441*^9, 
   3.6502847833662977`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    SqrtBox["2"]], ",", 
   FractionBox[
    RowBox[{"Csc", "[", "u", "]"}], 
    SqrtBox["2"]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6500956136642103`*^9, 3.650095666421328*^9, 3.650095790626585*^9, 
   3.650095982865837*^9, 3.650096139384556*^9, 3.650096332100031*^9, 
   3.6500963715362473`*^9, 3.6500967297868567`*^9, 3.650097004393835*^9, 
   3.650097463892436*^9, 3.650097603399654*^9, 3.650097687350492*^9, 
   3.650098059067706*^9, {3.6500981255586452`*^9, 3.6500981422928047`*^9}, 
   3.650098179482504*^9, 3.650098229208501*^9, 3.650098306920218*^9, {
   3.650098358637048*^9, 3.650098377851297*^9}, 3.650098419442404*^9, 
   3.65009881695048*^9, 3.65009889075694*^9, 3.6500989836073923`*^9, 
   3.650099174116123*^9, 3.650099326564844*^9, 3.650099761933268*^9, 
   3.6500998334110527`*^9, 3.650100148716216*^9, 3.650100244389867*^9, 
   3.650101865586199*^9, 3.650101967157099*^9, 3.650102167536441*^9, 
   3.650284783386497*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    SqrtBox["2"]], ",", 
   FractionBox[
    RowBox[{"Sin", "[", "u", "]"}], 
    SqrtBox["2"]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6500956136642103`*^9, 3.650095666421328*^9, 3.650095790626585*^9, 
   3.650095982865837*^9, 3.650096139384556*^9, 3.650096332100031*^9, 
   3.6500963715362473`*^9, 3.6500967297868567`*^9, 3.650097004393835*^9, 
   3.650097463892436*^9, 3.650097603399654*^9, 3.650097687350492*^9, 
   3.650098059067706*^9, {3.6500981255586452`*^9, 3.6500981422928047`*^9}, 
   3.650098179482504*^9, 3.650098229208501*^9, 3.650098306920218*^9, {
   3.650098358637048*^9, 3.650098377851297*^9}, 3.650098419442404*^9, 
   3.65009881695048*^9, 3.65009889075694*^9, 3.6500989836073923`*^9, 
   3.650099174116123*^9, 3.650099326564844*^9, 3.650099761933268*^9, 
   3.6500998334110527`*^9, 3.650100148716216*^9, 3.650100244389867*^9, 
   3.650101865586199*^9, 3.650101967157099*^9, 3.650102167536441*^9, 
   3.650284783388427*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.6500956136642103`*^9, 3.650095666421328*^9, 3.650095790626585*^9, 
   3.650095982865837*^9, 3.650096139384556*^9, 3.650096332100031*^9, 
   3.6500963715362473`*^9, 3.6500967297868567`*^9, 3.650097004393835*^9, 
   3.650097463892436*^9, 3.650097603399654*^9, 3.650097687350492*^9, 
   3.650098059067706*^9, {3.6500981255586452`*^9, 3.6500981422928047`*^9}, 
   3.650098179482504*^9, 3.650098229208501*^9, 3.650098306920218*^9, {
   3.650098358637048*^9, 3.650098377851297*^9}, 3.650098419442404*^9, 
   3.65009881695048*^9, 3.65009889075694*^9, 3.6500989836073923`*^9, 
   3.650099174116123*^9, 3.650099326564844*^9, 3.650099761933268*^9, 
   3.6500998334110527`*^9, 3.650100148716216*^9, 3.650100244389867*^9, 
   3.650101865586199*^9, 3.650101967157099*^9, 3.650102167536441*^9, 
   3.650284783389069*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rotq", "=", 
  RowBox[{
   RowBox[{"Hodge2", "[", 
    RowBox[{
     RowBox[{"ExD1", "[", 
      RowBox[{"flq", ",", "u", ",", "v"}], "]"}], ",", "g"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"normrotq", "=", 
  RowBox[{
   RowBox[{"rotq", "^", "2"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.650095728295767*^9, 3.650095765186534*^9}, {
  3.650095808634041*^9, 3.6500958176105833`*^9}, {3.650095863477292*^9, 
  3.6500959423232527`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"Cot", "[", "u", "]"}], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{
  3.650095943228484*^9, 3.650095985191876*^9, 3.6500961393884077`*^9, 
   3.650096333055093*^9, 3.650096371692341*^9, 3.650097004439144*^9, 
   3.650097468410849*^9, 3.650097603459968*^9, 3.650097687399675*^9, 
   3.650098061633074*^9, {3.6500981256141872`*^9, 3.650098142339314*^9}, 
   3.650098179536969*^9, 3.650098229259357*^9, 3.650098306976944*^9, {
   3.650098358641985*^9, 3.6500983779035063`*^9}, 3.650098419514447*^9, 
   3.6500988170048428`*^9, 3.6500988908323193`*^9, 3.650098983694607*^9, 
   3.65009917417717*^9, 3.650099326622774*^9, 3.6500997620052958`*^9, 
   3.650099833466309*^9, 3.650100244417603*^9, 3.65010186571251*^9, 
   3.6501019672300243`*^9, 3.6501021675889606`*^9, 3.650284783416675*^9}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox[
   RowBox[{"Cot", "[", "u", "]"}], "2"], "2"]], "Output",
 CellChangeTimes->{
  3.650095943228484*^9, 3.650095985191876*^9, 3.6500961393884077`*^9, 
   3.650096333055093*^9, 3.650096371692341*^9, 3.650097004439144*^9, 
   3.650097468410849*^9, 3.650097603459968*^9, 3.650097687399675*^9, 
   3.650098061633074*^9, {3.6500981256141872`*^9, 3.650098142339314*^9}, 
   3.650098179536969*^9, 3.650098229259357*^9, 3.650098306976944*^9, {
   3.650098358641985*^9, 3.6500983779035063`*^9}, 3.650098419514447*^9, 
   3.6500988170048428`*^9, 3.6500988908323193`*^9, 3.650098983694607*^9, 
   3.65009917417717*^9, 3.650099326622774*^9, 3.6500997620052958`*^9, 
   3.650099833466309*^9, 3.650100244417603*^9, 3.65010186571251*^9, 
   3.6501019672300243`*^9, 3.6501021675889606`*^9, 3.650284783437421*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"divq", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"ExCoD1", "[", 
     RowBox[{"q", ",", "u", ",", "v", ",", "g"}], "]"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"normdivq", "=", 
  RowBox[{
   RowBox[{"divq", "^", "2"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.650095995501219*^9, 3.650096052581781*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"Cot", "[", "u", "]"}], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{
  3.6500960532853928`*^9, 3.650096139399179*^9, 3.650096339571168*^9, 
   3.65009637180691*^9, 3.650097004468721*^9, 3.650097471299823*^9, 
   3.650097603486746*^9, 3.650097687430719*^9, 3.6500980642597723`*^9, {
   3.650098125653049*^9, 3.650098142389076*^9}, 3.650098179568596*^9, 
   3.650098229286058*^9, 3.650098306994627*^9, {3.6500983586455507`*^9, 
   3.65009837793713*^9}, 3.6500984195914307`*^9, 3.650098817048156*^9, 
   3.650098890925289*^9, 3.650098983834128*^9, 3.650099174235461*^9, 
   3.650099326688198*^9, 3.650099762079769*^9, 3.6500998335296593`*^9, 
   3.650100244444216*^9, 3.6501018658352537`*^9, 3.650101967313229*^9, 
   3.650102167634305*^9, 3.6502847834580297`*^9}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox[
   RowBox[{"Cot", "[", "u", "]"}], "2"], "2"]], "Output",
 CellChangeTimes->{
  3.6500960532853928`*^9, 3.650096139399179*^9, 3.650096339571168*^9, 
   3.65009637180691*^9, 3.650097004468721*^9, 3.650097471299823*^9, 
   3.650097603486746*^9, 3.650097687430719*^9, 3.6500980642597723`*^9, {
   3.650098125653049*^9, 3.650098142389076*^9}, 3.650098179568596*^9, 
   3.650098229286058*^9, 3.650098306994627*^9, {3.6500983586455507`*^9, 
   3.65009837793713*^9}, 3.6500984195914307`*^9, 3.650098817048156*^9, 
   3.650098890925289*^9, 3.650098983834128*^9, 3.650099174235461*^9, 
   3.650099326688198*^9, 3.650099762079769*^9, 3.6500998335296593`*^9, 
   3.650100244444216*^9, 3.6501018658352537`*^9, 3.650101967313229*^9, 
   3.650102167634305*^9, 3.650284783458736*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eq", "=", 
  RowBox[{
   RowBox[{"normrotq", "+", "normdivq"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.650096058411908*^9, 3.6500960893517227`*^9}, {
  3.6500962837922363`*^9, 3.650096284628221*^9}, {3.650096403485331*^9, 
  3.650096436807452*^9}}],

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"Cot", "[", "u", "]"}], "2"]], "Output",
 CellChangeTimes->{
  3.6500960900808563`*^9, 3.650096139405377*^9, 3.6500962963481703`*^9, {
   3.650096382521482*^9, 3.65009640569263*^9}, 3.650096439231542*^9, 
   3.6500970044927464`*^9, 3.650097476109025*^9, 3.650097603524558*^9, 
   3.650097687465109*^9, 3.650098067687624*^9, {3.650098126263789*^9, 
   3.650098142464904*^9}, 3.650098179634306*^9, 3.650098229318206*^9, 
   3.6500983070252523`*^9, {3.6500983586687517`*^9, 3.6500983779872026`*^9}, 
   3.6500984196904583`*^9, 3.650098817113962*^9, 3.6500988910845222`*^9, 
   3.6500989840360403`*^9, 3.6500991743521214`*^9, 3.650099326780081*^9, 
   3.6500997637025537`*^9, 3.650099833619735*^9, 3.650100244490162*^9, 
   3.6501018661138487`*^9, 3.65010196755265*^9, 3.650102167690311*^9, 
   3.6502847834917383`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NIntegrate", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"Eq", "*", "vol"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"u", ",", 
     RowBox[{"\[Pi]", "/", "4"}], ",", 
     RowBox[{"3", "*", 
      RowBox[{"\[Pi]", "/", "4"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"v", ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.650096196221257*^9, 3.650096231142413*^9}, {
  3.650096444364393*^9, 3.650096524198242*^9}, {3.650096801784848*^9, 
  3.650096852325569*^9}, {3.6500971575278788`*^9, 3.6500972406635103`*^9}, {
  3.650097281262258*^9, 3.650097352363194*^9}, {3.650097862962208*^9, 
  3.650097896124509*^9}, {3.650098257622404*^9, 3.650098290169046*^9}}],

Cell[BoxData["2.1899012688177666`"], "Output",
 CellChangeTimes->{{3.6500972200842857`*^9, 3.6500972421169243`*^9}, {
   3.650097298262854*^9, 3.650097353356539*^9}, 3.650097603847434*^9, 
   3.6500976876313877`*^9, 3.6500978665662613`*^9, 3.650097897027182*^9, {
   3.65009814193751*^9, 3.650098143305572*^9}, 3.650098180063964*^9, 
   3.6500982295707903`*^9, {3.6500982863203077`*^9, 3.650098307047248*^9}, {
   3.6500983586936293`*^9, 3.650098378010157*^9}, 3.650098419713402*^9, 
   3.650098817139461*^9, 3.650098891126212*^9, 3.650098984058782*^9, 
   3.650099174432411*^9, 3.650099326811989*^9, 3.650099763978796*^9, 
   3.65009983365303*^9, 3.6501002445209093`*^9, 3.650101866171788*^9, 
   3.6501019675885687`*^9, 3.6501021677136497`*^9, 3.650284783847349*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"q", "=", 
  RowBox[{"TrigExpand", "[", "q", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SetOptions", "[", 
  RowBox[{"Simplify", ",", 
   RowBox[{"Trig", "\[Rule]", "False"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"qR3", "=", 
  RowBox[{
   RowBox[{"GlobalVecFromPara", "[", 
    RowBox[{"q", ",", "X", ",", "u", ",", "v"}], "]"}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.650099235849538*^9, 3.650099279059092*^9}, {
  3.650100256326789*^9, 3.650100294707505*^9}, {3.650100339989147*^9, 
  3.650100346963241*^9}, {3.650100685730857*^9, 3.65010074670361*^9}, {
  3.6501008084827147`*^9, 3.6501008263981133`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    SqrtBox["2"]], ",", 
   FractionBox[
    RowBox[{"Csc", "[", "u", "]"}], 
    SqrtBox["2"]]}], "}"}]], "Output",
 CellChangeTimes->{{3.650099251682047*^9, 3.6500992798902817`*^9}, 
   3.6500993268317204`*^9, 3.650099763996801*^9, 3.650099833677724*^9, 
   3.650100178671036*^9, 3.650100244538835*^9, 3.650100295728737*^9, 
   3.650100347861434*^9, 3.650100747248987*^9, {3.650100816723386*^9, 
   3.6501008269348392`*^9}, 3.650101866192034*^9, 3.6501019676096563`*^9, 
   3.6501021677326193`*^9, 3.650284783850967*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Assumptions", "\[RuleDelayed]", "$Assumptions"}], ",", 
   RowBox[{"ComplexityFunction", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"ExcludedForms", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"TimeConstraint", "\[Rule]", "300"}], ",", 
   RowBox[{"TransformationFunctions", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"Trig", "\[Rule]", "False"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.650099251682047*^9, 3.6500992798902817`*^9}, 
   3.6500993268317204`*^9, 3.650099763996801*^9, 3.650099833677724*^9, 
   3.650100178671036*^9, 3.650100244538835*^9, 3.650100295728737*^9, 
   3.650100347861434*^9, 3.650100747248987*^9, {3.650100816723386*^9, 
   3.6501008269348392`*^9}, 3.650101866192034*^9, 3.6501019676096563`*^9, 
   3.6501021677326193`*^9, 3.650284783851795*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "u", "]"}], " ", 
      RowBox[{"Cos", "[", "v", "]"}]}], "-", 
     RowBox[{"Sin", "[", "v", "]"}]}], 
    SqrtBox["2"]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", "v", "]"}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", "u", "]"}], " ", 
      RowBox[{"Sin", "[", "v", "]"}]}]}], 
    SqrtBox["2"]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"Sin", "[", "u", "]"}], 
     SqrtBox["2"]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.650099251682047*^9, 3.6500992798902817`*^9}, 
   3.6500993268317204`*^9, 3.650099763996801*^9, 3.650099833677724*^9, 
   3.650100178671036*^9, 3.650100244538835*^9, 3.650100295728737*^9, 
   3.650100347861434*^9, 3.650100747248987*^9, {3.650100816723386*^9, 
   3.6501008269348392`*^9}, 3.650101866192034*^9, 3.6501019676096563`*^9, 
   3.6501021677326193`*^9, 3.650284783855402*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"repRules", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Cot", "[", "u", "]"}], "\[Rule]", 
     RowBox[{"z", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"z", "^", "2"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"Cos", "[", "u", "]"}], "\[Rule]", "z"}], ",", 
    RowBox[{
     RowBox[{"Sin", "[", "u", "]"}], "\[Rule]", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "-", 
       RowBox[{"z", "^", "2"}]}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"Sin", "[", "v", "]"}], "\[Rule]", 
     RowBox[{"y", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"z", "^", "2"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"Cos", "[", "v", "]"}], "\[Rule]", 
     RowBox[{"x", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"z", "^", "2"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"u", "/", "2"}], "]"}], "\[Rule]", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "z"}], ")"}], "/", "2"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"Sec", "[", 
      RowBox[{"u", "/", "2"}], "]"}], "\[Rule]", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"2", "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", "z"}], ")"}]}], "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.650101111844516*^9, 3.650101203030583*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Cot", "[", "u", "]"}], "\[Rule]", 
    FractionBox["z", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["z", "2"]}]]]}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", "u", "]"}], "\[Rule]", "z"}], ",", 
   RowBox[{
    RowBox[{"Sin", "[", "u", "]"}], "\[Rule]", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["z", "2"]}]]}], ",", 
   RowBox[{
    RowBox[{"Sin", "[", "v", "]"}], "\[Rule]", 
    FractionBox["y", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["z", "2"]}]]]}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", "v", "]"}], "\[Rule]", 
    FractionBox["x", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["z", "2"]}]]]}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox["u", "2"], "]"}], "\[Rule]", 
    FractionBox[
     SqrtBox[
      RowBox[{"1", "+", "z"}]], 
     SqrtBox["2"]]}], ",", 
   RowBox[{
    RowBox[{"Sec", "[", 
     FractionBox["u", "2"], "]"}], "\[Rule]", 
    RowBox[{
     SqrtBox["2"], " ", 
     SqrtBox[
      FractionBox["1", 
       RowBox[{"1", "+", "z"}]]]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.650100796528139*^9, 3.650101204214013*^9, 
  3.6501018662387123`*^9, 3.650101967661931*^9, 3.650102167770911*^9, 
  3.650284783859099*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qGlob", "=", 
  RowBox[{
   RowBox[{"qR3", "/.", "repRules"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.650100800998946*^9, 3.650100838926897*^9}, {
  3.650101214669433*^9, 3.6501012259278727`*^9}, {3.650101327918812*^9, 
  3.650101331648121*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "y"}], "+", 
     RowBox[{"x", " ", "z"}]}], 
    SqrtBox[
     RowBox[{"2", "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "2"]}]}]]], ",", 
   FractionBox[
    RowBox[{"x", "+", 
     RowBox[{"y", " ", "z"}]}], 
    SqrtBox[
     RowBox[{"2", "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "2"]}]}]]], ",", 
   RowBox[{"-", 
    FractionBox[
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["z", "2"]}]], 
     SqrtBox["2"]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6501008396240063`*^9, {3.650101211021616*^9, 3.650101226817691*^9}, 
   3.650101332906034*^9, 3.6501018664439373`*^9, 3.650101967769073*^9, 
   3.650102167999938*^9, 3.650284783925254*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qGlob", "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qGlob", "*", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"z", "^", "2"}]}], ")"}]}], "]"}]}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.650101336297618*^9, 3.6501013442279*^9}, {
  3.650285238923724*^9, 3.650285271931082*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "y"}], "+", 
     RowBox[{"x", " ", "z"}]}], 
    SqrtBox[
     RowBox[{"2", "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "2"]}]}]]], ",", 
   FractionBox[
    RowBox[{"x", "+", 
     RowBox[{"y", " ", "z"}]}], 
    SqrtBox[
     RowBox[{"2", "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["z", "2"]}]}]]], ",", 
   RowBox[{"-", 
    FractionBox[
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["z", "2"]}]], 
     SqrtBox["2"]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.650101344814896*^9, 3.6501018664800663`*^9, 3.650101967801445*^9, 
   3.650102168041403*^9, 3.650284783946898*^9, {3.650285253662752*^9, 
   3.650285273102208*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "y"}], "+", 
    RowBox[{"x", " ", "z"}]}], ",", 
   RowBox[{"x", "+", 
    RowBox[{"y", " ", "z"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox["z", "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.650101344814896*^9, 3.6501018664800663`*^9, 3.650101967801445*^9, 
   3.650102168041403*^9, 3.650284783946898*^9, {3.650285253662752*^9, 
   3.6502852731035*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qGlobNorm", "=", 
  RowBox[{
   RowBox[{"qGlob", ".", "qGlob"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qGlobNorm", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "^", "2"}], "\[Rule]", 
     RowBox[{"1", "-", 
      RowBox[{"y", "^", "2"}], "-", 
      RowBox[{"z", "^", "2"}]}]}], "}"}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.650102264074985*^9, 3.65010237284888*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["z", "2"]}], ")"}], "2"], "+", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["z", "2"]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["y", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["z", "2"]}], ")"}]}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["z", "2"]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.6501022734774103`*^9, {3.650102320589231*^9, 3.650102337906958*^9}, 
   3.650102373498746*^9, 3.650284783977178*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.6501022734774103`*^9, {3.650102320589231*^9, 3.650102337906958*^9}, 
   3.650102373498746*^9, 3.650284783978025*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"p", "\[IndentingNewLine]", 
 RowBox[{"pGlob", "=", 
  RowBox[{
   RowBox[{"GlobalVecFromPara", "[", 
    RowBox[{"p", ",", "X", ",", "u", ",", "v"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"pR3", "=", 
  RowBox[{
   RowBox[{"pGlob", "/.", "repRules"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.6502849334841423`*^9, 3.650285010417563*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.650284999544035*^9, 3.65028501108182*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "u", "]"}], " ", 
    RowBox[{"Cos", "[", "v", "]"}]}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", "u", "]"}], " ", 
    RowBox[{"Sin", "[", "v", "]"}]}], ",", 
   RowBox[{"-", 
    RowBox[{"Sin", "[", "u", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.650284999544035*^9, 3.650285011082437*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"x", " ", "z"}], 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["z", "2"]}]]], ",", 
   FractionBox[
    RowBox[{"y", " ", "z"}], 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["z", "2"]}]]], ",", 
   RowBox[{"-", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["z", "2"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.650284999544035*^9, 3.650285011083026*^9}}]
}, Open  ]]
},
WindowSize->{1280, 975},
WindowMargins->{{Automatic, 1024}, {Automatic, 0}},
FrontEndVersion->"8.0 for Linux x86 (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 60, 1, 30, "Input"],
Cell[CellGroupData[{
Cell[642, 25, 246, 5, 30, "Input"],
Cell[891, 32, 1040, 19, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1968, 56, 2901, 67, 145, "Input"],
Cell[4872, 125, 2038, 34, 30, "Output"],
Cell[6913, 161, 1982, 33, 34, "Output"],
Cell[8898, 196, 1980, 33, 34, "Output"],
Cell[10881, 231, 1807, 26, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12725, 262, 950, 28, 88, "Input"],
Cell[13678, 292, 881, 19, 30, "Output"],
Cell[14562, 313, 852, 18, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15451, 336, 666, 20, 69, "Input"],
Cell[16120, 358, 1675, 24, 30, "Output"],
Cell[17798, 384, 1675, 24, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19510, 413, 1770, 55, 164, "Input"],
Cell[21283, 470, 2366, 39, 34, "Output"],
Cell[23652, 511, 2305, 37, 30, "Output"],
Cell[25960, 550, 2118, 29, 30, "Output"],
Cell[28081, 581, 2118, 29, 30, "Output"],
Cell[30202, 612, 2118, 29, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32357, 646, 1070, 29, 107, "Input"],
Cell[33430, 677, 987, 18, 30, "Output"],
Cell[34420, 697, 989, 18, 30, "Output"],
Cell[35412, 717, 877, 14, 30, "Output"],
Cell[36292, 733, 832, 12, 30, "Output"],
Cell[37127, 747, 877, 14, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38041, 766, 2650, 57, 145, "Input"],
Cell[40694, 825, 881, 14, 45, "Output"],
Cell[41578, 841, 885, 14, 45, "Output"],
Cell[42466, 857, 1008, 20, 52, "Output"],
Cell[43477, 879, 1008, 20, 53, "Output"],
Cell[44488, 901, 859, 13, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45384, 919, 504, 13, 50, "Input"],
Cell[45891, 934, 827, 14, 52, "Output"],
Cell[46721, 950, 840, 14, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47598, 969, 370, 10, 50, "Input"],
Cell[47971, 981, 803, 14, 52, "Output"],
Cell[48777, 997, 814, 14, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49628, 1016, 291, 6, 30, "Input"],
Cell[49922, 1024, 856, 14, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50815, 1043, 748, 17, 30, "Input"],
Cell[51566, 1062, 768, 10, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52371, 1077, 658, 14, 69, "Input"],
Cell[53032, 1093, 583, 13, 52, "Output"],
Cell[53618, 1108, 836, 15, 50, "Output"],
Cell[54457, 1125, 955, 26, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55449, 1156, 1410, 43, 50, "Input"],
Cell[56862, 1201, 1303, 45, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58202, 1251, 288, 6, 30, "Input"],
Cell[58493, 1259, 783, 27, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59313, 1291, 405, 11, 50, "Input"],
Cell[59721, 1304, 759, 27, 59, "Output"],
Cell[60483, 1333, 458, 14, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60978, 1352, 452, 13, 50, "Input"],
Cell[61433, 1367, 765, 26, 59, "Output"],
Cell[62201, 1395, 169, 3, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62407, 1403, 395, 9, 69, "Input"],
Cell[62805, 1414, 138, 3, 30, "Output"],
Cell[62946, 1419, 376, 11, 30, "Output"],
Cell[63325, 1432, 466, 17, 54, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
